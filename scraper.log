2025-04-20 16:00:32,118 - __main__ - INFO - Starting Dutch Real Estate Scraper at 2025-04-20 16:00:32.118623
2025-04-20 16:00:32,128 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 16:00:32,129 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 16:00:32,129 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:00:32,129 - __main__ - INFO - Telegram notifications enabled
2025-04-20 16:00:32,137 - database.migrations - INFO - Database initialized successfully
2025-04-20 16:00:32,150 - database.migrations - INFO - Telegram database tables initialized successfully
2025-04-20 16:00:32,155 - database.migrations - INFO - Telegram database tables initialized successfully
2025-04-20 16:00:32,223 - telegram_bot.telegram_integration - INFO - Telegram integration initialized
2025-04-20 16:00:32,223 - telegram_bot.telegram_integration - INFO - Telegram integration started
2025-04-20 16:00:32,228 - telegram_bot.telegram_notification_manager - INFO - Starting continuous notification processing (interval: 300s)
2025-04-20 16:00:32,233 - telegram_bot.telegram_notification_manager - INFO - No pending notifications to process
2025-04-20 16:00:32,234 - telegram_bot.telegram_notification_manager - INFO - Notification run completed in 0.01s: 0 sent, 0 failed
2025-04-20 16:00:32,234 - telegram_bot.telegram_notification_manager - INFO - Waiting 300 seconds until next notification run...
2025-04-20 16:00:32,294 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getMe "HTTP/1.1 200 OK"
2025-04-20 16:00:32,294 - telegram.ext.Application - INFO - Application started
2025-04-20 16:00:32,310 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/deleteWebhook "HTTP/1.1 200 OK"
2025-04-20 16:00:32,310 - telegram_bot.telegram_bot - INFO - Bot started successfully!
2025-04-20 16:00:32,350 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/sendMessage "HTTP/1.1 200 OK"
2025-04-20 16:00:32,350 - telegram_bot.telegram_integration - INFO - Notification sent to admin 6922263642
2025-04-20 16:00:32,350 - __main__ - INFO - Telegram bot and notification manager started
2025-04-20 16:00:32,350 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 16:00:32,350 - main - INFO - Starting new scan cycle...
2025-04-20 16:00:32,353 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:00:32,353 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:00:33,299 - httpx - INFO - HTTP Request: GET https://www.funda.nl/zoeken/huur?object_type=[%22house%22,%22apartment%22]&publication_date=%221%22&sort=%22date_down%22 "HTTP/1.1 200 OK"
2025-04-20 16:00:33,320 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:00:33,326 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:00:33,475 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.12s
2025-04-20 16:00:33,475 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:00:33,475 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:00:33,475 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:00:33,475 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:00:33,476 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:00:33,476 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:00:33,476 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:00:33,476 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:00:33,476 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:00:33,476 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:00:33,476 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:00:34,662 - httpx - INFO - HTTP Request: GET https://www.pararius.com/apartments/nederland/since-1 "HTTP/1.1 200 OK"
2025-04-20 16:00:34,687 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:00:34,693 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.22s
2025-04-20 16:00:34,693 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:00:34,693 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:00:34,693 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:00:34,693 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:00:34,693 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:00:34,693 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:00:34,693 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:00:34,693 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:00:34,693 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:00:34,693 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:00:34,693 - main - INFO - City-based scanning skipped
2025-04-20 16:00:34,693 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:00:34,693 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:00:34,704 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:00:34,704 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:00:42,376 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:00:53,408 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:01:04,440 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:01:15,477 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:01:26,510 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:01:37,536 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:01:48,576 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:01:51,748 - telegram_bot.telegram_notification_manager - INFO - Notification task cancelled
2025-04-20 16:01:51,750 - main - INFO - Scraper task cancelled
2025-04-20 16:01:51,855 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/sendMessage "HTTP/1.1 200 OK"
2025-04-20 16:01:51,857 - telegram_bot.telegram_integration - INFO - Notification sent to admin 6922263642
2025-04-20 16:01:51,857 - telegram.ext.Application - INFO - Application is stopping. This might take a moment.
2025-04-20 16:01:51,857 - telegram.ext.Application - CRITICAL - Fetching updates was aborted due to CancelledError(). Suppressing exception to ensure graceful shutdown.
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 636, in run_until_complete
    self.run_forever()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 603, in run_forever
    self._run_once()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 1871, in _run_once
    event_list = self._selector.select(timeout)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/selectors.py", line 562, in select
    kev_list = self._selector.control(None, max_ev, timeout)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kevinhang/Documents/HousingProject/.venv/lib/python3.10/site-packages/telegram/ext/_application.py", line 1221, in _update_fetcher
    await self.__update_fetcher()
  File "/Users/kevinhang/Documents/HousingProject/.venv/lib/python3.10/site-packages/telegram/ext/_application.py", line 1200, in __update_fetcher
    update = await self.update_queue.get()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/queues.py", line 159, in get
    await getter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kevinhang/Documents/HousingProject/.venv/lib/python3.10/site-packages/telegram/ext/_application.py", line 670, in stop
    self.__update_fetcher_task.result()
asyncio.exceptions.CancelledError
2025-04-20 16:01:51,863 - telegram.ext.Application - INFO - Application.stop() complete
2025-04-20 16:01:51,863 - telegram_bot.telegram_integration - INFO - Telegram integration stopped
2025-04-20 16:01:51,864 - __main__ - INFO - Telegram integration stopped
2025-04-20 16:01:54,835 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:01:54,837 - asyncio - ERROR - unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-2' coro=<TelegramRealEstateBot.run() done, defined at /Users/kevinhang/Documents/HousingProject/telegram_bot/telegram_bot.py:1099> exception=RuntimeError('This Application is not running!')>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 636, in run_until_complete
    self.run_forever()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 603, in run_forever
    self._run_once()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 1871, in _run_once
    event_list = self._selector.select(timeout)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/selectors.py", line 562, in select
    kev_list = self._selector.control(None, max_ev, timeout)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kevinhang/Documents/HousingProject/telegram_bot/telegram_bot.py", line 1116, in run
    await asyncio.sleep(3600)  # Sleep to keep the event loop alive
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 605, in sleep
    return await future
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kevinhang/Documents/HousingProject/telegram_bot/telegram_bot.py", line 1123, in run
    await self.application.stop()
  File "/Users/kevinhang/Documents/HousingProject/.venv/lib/python3.10/site-packages/telegram/ext/_application.py", line 660, in stop
    raise RuntimeError("This Application is not running!")
RuntimeError: This Application is not running!
2025-04-20 16:02:16,817 - __main__ - INFO - Starting Dutch Real Estate Scraper at 2025-04-20 16:02:16.817406
2025-04-20 16:02:16,828 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 16:02:16,828 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 16:02:16,829 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:02:16,829 - __main__ - INFO - Telegram notifications enabled
2025-04-20 16:02:16,839 - database.migrations - INFO - Database initialized successfully
2025-04-20 16:02:16,853 - database.migrations - INFO - Telegram database tables initialized successfully
2025-04-20 16:02:16,859 - database.migrations - INFO - Telegram database tables initialized successfully
2025-04-20 16:02:16,932 - telegram_bot.telegram_integration - INFO - Telegram integration initialized
2025-04-20 16:02:16,932 - telegram_bot.telegram_integration - INFO - Telegram integration started
2025-04-20 16:02:16,939 - telegram_bot.telegram_notification_manager - INFO - Starting continuous notification processing (interval: 300s)
2025-04-20 16:02:16,946 - telegram_bot.telegram_notification_manager - INFO - No pending notifications to process
2025-04-20 16:02:16,946 - telegram_bot.telegram_notification_manager - INFO - Notification run completed in 0.01s: 0 sent, 0 failed
2025-04-20 16:02:16,946 - telegram_bot.telegram_notification_manager - INFO - Waiting 300 seconds until next notification run...
2025-04-20 16:02:16,998 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getMe "HTTP/1.1 200 OK"
2025-04-20 16:02:16,998 - telegram.ext.Application - INFO - Application started
2025-04-20 16:02:17,014 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/deleteWebhook "HTTP/1.1 200 OK"
2025-04-20 16:02:17,014 - telegram_bot.telegram_bot - INFO - Bot started successfully!
2025-04-20 16:02:17,067 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/sendMessage "HTTP/1.1 200 OK"
2025-04-20 16:02:17,068 - telegram_bot.telegram_integration - INFO - Notification sent to admin 6922263642
2025-04-20 16:02:17,068 - __main__ - INFO - Telegram bot and notification manager started
2025-04-20 16:02:17,068 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 16:02:17,068 - main - INFO - Starting new scan cycle...
2025-04-20 16:02:17,071 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:02:17,071 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:02:17,972 - httpx - INFO - HTTP Request: GET https://www.funda.nl/zoeken/huur?object_type=[%22house%22,%22apartment%22]&publication_date=%221%22&sort=%22date_down%22 "HTTP/1.1 200 OK"
2025-04-20 16:02:17,996 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:02:17,997 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:02:18,164 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.09s
2025-04-20 16:02:18,165 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:02:18,165 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:02:18,165 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:02:18,165 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:02:18,165 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:02:18,165 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:02:18,165 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:02:18,165 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:02:18,165 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:02:18,165 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:02:18,165 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:02:19,094 - httpx - INFO - HTTP Request: GET https://www.pararius.com/apartments/nederland/since-1 "HTTP/1.1 200 OK"
2025-04-20 16:02:19,141 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:02:19,146 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.98s
2025-04-20 16:02:19,146 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:02:19,147 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:02:19,147 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:02:19,147 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:02:19,147 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:02:19,147 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:02:19,147 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:02:19,147 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:02:19,147 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:02:19,147 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:02:19,147 - main - INFO - City-based scanning skipped
2025-04-20 16:02:19,147 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:02:19,147 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:02:19,158 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:02:19,158 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:02:21,147 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:02:21,159 - telegram_bot.telegram_bot - INFO - Entering preferences_command for user_id: 6922263642, state: MAIN_MENU
2025-04-20 16:02:21,200 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/sendMessage "HTTP/1.1 200 OK"
2025-04-20 16:02:24,920 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:02:24,922 - telegram_bot.telegram_bot - INFO - Received callback query: pref_city, user_id: 6922263642
2025-04-20 16:02:24,946 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/answerCallbackQuery "HTTP/1.1 200 OK"
2025-04-20 16:02:24,947 - telegram_bot.telegram_bot - INFO - Processing action: city
2025-04-20 16:02:24,982 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/editMessageText "HTTP/1.1 200 OK"
2025-04-20 16:02:24,984 - telegram_bot.telegram_bot - INFO - Transitioning to SETTING_CITY state
2025-04-20 16:02:29,049 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:02:29,089 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/sendMessage "HTTP/1.1 200 OK"
2025-04-20 16:02:29,128 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/sendMessage "HTTP/1.1 200 OK"
2025-04-20 16:02:36,683 - telegram_bot.telegram_notification_manager - INFO - Notification task cancelled
2025-04-20 16:02:36,684 - main - INFO - Scraper task cancelled
2025-04-20 16:02:36,768 - httpx - INFO - HTTP Request: POST https://api.telegram.org/bot7882217946:AAEHyfpsqZpZniZOhR48w6fF69tYQ1SJiZM/getUpdates "HTTP/1.1 200 OK"
2025-04-20 16:02:36,768 - telegram.ext.Application - INFO - Application is stopping. This might take a moment.
2025-04-20 16:02:36,768 - telegram.ext.Application - CRITICAL - Fetching updates was aborted due to CancelledError(). Suppressing exception to ensure graceful shutdown.
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 636, in run_until_complete
    self.run_forever()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 603, in run_forever
    self._run_once()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 1871, in _run_once
    event_list = self._selector.select(timeout)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/selectors.py", line 562, in select
    kev_list = self._selector.control(None, max_ev, timeout)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kevinhang/Documents/HousingProject/.venv/lib/python3.10/site-packages/telegram/ext/_application.py", line 1221, in _update_fetcher
    await self.__update_fetcher()
  File "/Users/kevinhang/Documents/HousingProject/.venv/lib/python3.10/site-packages/telegram/ext/_application.py", line 1200, in __update_fetcher
    update = await self.update_queue.get()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/queues.py", line 159, in get
    await getter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kevinhang/Documents/HousingProject/.venv/lib/python3.10/site-packages/telegram/ext/_application.py", line 670, in stop
    self.__update_fetcher_task.result()
asyncio.exceptions.CancelledError
2025-04-20 16:02:36,774 - telegram.ext.Application - INFO - Application.stop() complete
2025-04-20 16:02:36,775 - telegram_bot.telegram_integration - ERROR - Error sending notification to admin 6922263642: httpx.ReadError: 
2025-04-20 16:02:36,775 - __main__ - ERROR - Error stopping Telegram integration: This Application is not running!
2025-04-20 16:02:36,775 - telegram_bot.telegram_bot - INFO - Bot stopped successfully.
2025-04-20 16:04:15,607 - __main__ - INFO - Starting Dutch Real Estate Scraper at 2025-04-20 16:04:15.607273
2025-04-20 16:04:15,620 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 16:04:15,620 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 16:04:15,621 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:04:15,621 - __main__ - INFO - Telegram notifications enabled
2025-04-20 16:04:15,627 - database.migrations - INFO - Database initialized successfully
2025-04-20 16:04:15,640 - database.migrations - INFO - Telegram database tables initialized successfully
2025-04-20 16:04:15,645 - database.migrations - INFO - Telegram database tables initialized successfully
2025-04-20 16:04:15,718 - telegram_bot.telegram_integration - INFO - Telegram integration initialized
2025-04-20 16:04:15,718 - telegram_bot.telegram_integration - INFO - Telegram integration started
2025-04-20 16:04:15,723 - telegram_bot.telegram_notification_manager - INFO - Starting continuous notification processing (interval: 300s)
2025-04-20 16:04:15,732 - telegram_bot.telegram_notification_manager - INFO - No pending notifications to process
2025-04-20 16:04:15,732 - telegram_bot.telegram_notification_manager - INFO - Notification run completed in 0.01s: 0 sent, 0 failed
2025-04-20 16:04:15,732 - telegram_bot.telegram_notification_manager - INFO - Waiting 300 seconds until next notification run...
2025-04-20 16:04:15,830 - telegram_bot.telegram_bot - INFO - Bot started successfully!
2025-04-20 16:04:15,844 - telegram_bot.telegram_integration - INFO - Notification sent to admin 6922263642
2025-04-20 16:04:15,844 - __main__ - INFO - Telegram bot and notification manager started
2025-04-20 16:04:15,844 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 16:04:15,844 - main - INFO - Starting new scan cycle...
2025-04-20 16:04:15,850 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:04:15,850 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:04:16,979 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:04:16,980 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:04:17,229 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.38s
2025-04-20 16:04:17,229 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:04:17,229 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:04:17,230 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:04:17,230 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:04:17,230 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:04:17,230 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:04:17,230 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:04:17,230 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:04:17,230 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:04:17,230 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:04:17,230 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:04:18,073 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:04:18,083 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.85s
2025-04-20 16:04:18,083 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:04:18,083 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:04:18,083 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:04:18,083 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:04:18,083 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:04:18,083 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:04:18,083 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:04:18,083 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:04:18,083 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:04:18,083 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:04:18,083 - main - INFO - City-based scanning skipped
2025-04-20 16:04:18,083 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:04:18,083 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:04:18,099 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:04:18,099 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:04:25,087 - telegram_bot.telegram_bot - INFO - Entering preferences_command for user_id: 6922263642, state: MAIN_MENU
2025-04-20 16:09:15,742 - telegram_bot.telegram_notification_manager - INFO - No pending notifications to process
2025-04-20 16:09:15,743 - telegram_bot.telegram_notification_manager - INFO - Notification run completed in 0.01s: 0 sent, 0 failed
2025-04-20 16:09:15,746 - telegram_bot.telegram_notification_manager - INFO - Cleaned up 0 old notifications
2025-04-20 16:09:15,747 - telegram_bot.telegram_notification_manager - INFO - Waiting 300 seconds until next notification run...
2025-04-20 16:09:18,104 - main - INFO - Starting new scan cycle...
2025-04-20 16:09:18,111 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:09:18,111 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:09:19,145 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:09:19,146 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:09:19,160 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.05s
2025-04-20 16:09:19,160 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:09:19,160 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:09:19,160 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:09:19,160 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:09:19,160 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:09:19,160 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:09:19,160 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:09:19,160 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:09:19,160 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:09:19,160 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:09:19,160 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:09:20,252 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:09:20,265 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.10s
2025-04-20 16:09:20,265 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:09:20,265 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:09:20,265 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:09:20,265 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:09:20,265 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:09:20,265 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:09:20,265 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:09:20,265 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:09:20,266 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:09:20,266 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:09:20,266 - main - INFO - City-based scanning skipped
2025-04-20 16:09:20,266 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:09:20,266 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:09:20,269 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:09:20,270 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:09:45,404 - telegram_bot.telegram_notification_manager - INFO - Notification task cancelled
2025-04-20 16:09:45,404 - main - INFO - Scraper task cancelled
2025-04-20 16:09:45,429 - telegram.ext.Application - CRITICAL - Fetching updates was aborted due to CancelledError(). Suppressing exception to ensure graceful shutdown.
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 636, in run_until_complete
    self.run_forever()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 603, in run_forever
    self._run_once()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 1871, in _run_once
    event_list = self._selector.select(timeout)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/selectors.py", line 562, in select
    kev_list = self._selector.control(None, max_ev, timeout)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kevinhang/Documents/HousingProject/.venv/lib/python3.10/site-packages/telegram/ext/_application.py", line 1221, in _update_fetcher
    await self.__update_fetcher()
  File "/Users/kevinhang/Documents/HousingProject/.venv/lib/python3.10/site-packages/telegram/ext/_application.py", line 1200, in __update_fetcher
    update = await self.update_queue.get()
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/queues.py", line 159, in get
    await getter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/kevinhang/Documents/HousingProject/.venv/lib/python3.10/site-packages/telegram/ext/_application.py", line 670, in stop
    self.__update_fetcher_task.result()
asyncio.exceptions.CancelledError
2025-04-20 16:09:45,434 - telegram_bot.telegram_bot - INFO - Bot stopped successfully.
2025-04-20 16:09:45,557 - telegram_bot.telegram_integration - INFO - Notification sent to admin 6922263642
2025-04-20 16:09:45,558 - __main__ - ERROR - Error stopping Telegram integration: This Application is not running!
2025-04-20 16:09:51,489 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 16:09:51.489695
2025-04-20 16:09:51,513 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 16:09:51,513 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 16:09:51,514 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:09:51,522 - database.migrations - INFO - Database initialized successfully
2025-04-20 16:09:51,529 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 16:09:51,529 - main - INFO - Starting new scan cycle...
2025-04-20 16:09:51,532 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:09:51,532 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:09:52,586 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:09:52,588 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:09:52,619 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.09s
2025-04-20 16:09:52,619 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:09:52,620 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:09:52,620 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:09:52,620 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:09:52,620 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:09:52,620 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:09:52,620 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:09:52,620 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:09:52,620 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:09:52,620 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:09:52,620 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:09:53,459 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:09:53,465 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.84s
2025-04-20 16:09:53,465 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:09:53,465 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:09:53,465 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:09:53,465 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:09:53,465 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:09:53,465 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:09:53,465 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:09:53,465 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:09:53,465 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:09:53,465 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:09:53,465 - main - INFO - City-based scanning skipped
2025-04-20 16:09:53,465 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:09:53,465 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:09:53,469 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:09:53,469 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:14:53,476 - main - INFO - Starting new scan cycle...
2025-04-20 16:14:53,488 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:14:53,488 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:14:54,664 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 16:14:54,664 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:14:54,664 - utils.http - INFO - Anti-bot retry 1/3 using Firefox Windows profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down", waiting 4.4 seconds...
2025-04-20 16:15:00,005 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:15:00,008 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:15:00,008 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:15:00,017 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 6.53s
2025-04-20 16:15:00,018 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:15:00,018 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:15:00,018 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:15:00,018 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:15:00,018 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:15:00,018 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:15:00,018 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:15:00,018 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:15:00,018 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:15:00,018 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:15:00,018 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:15:01,237 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:15:01,251 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.23s
2025-04-20 16:15:01,251 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:15:01,251 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:15:01,251 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:15:01,251 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:15:01,251 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:15:01,252 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:15:01,252 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:15:01,252 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:15:01,252 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:15:01,252 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:15:01,252 - main - INFO - City-based scanning skipped
2025-04-20 16:15:01,252 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:15:01,252 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:15:01,255 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:15:01,256 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:20:01,263 - main - INFO - Starting new scan cycle...
2025-04-20 16:20:01,272 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:20:01,272 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:20:01,954 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 16:20:01,954 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:20:01,955 - utils.http - INFO - Anti-bot retry 1/3 using Edge Windows profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down", waiting 4.9 seconds...
2025-04-20 16:20:08,679 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:20:08,681 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:20:08,681 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:20:08,691 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 7.42s
2025-04-20 16:20:08,692 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:20:08,692 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:20:08,692 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:20:08,692 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:20:08,692 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:20:08,692 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:20:08,692 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:20:08,692 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:20:08,692 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:20:08,692 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:20:08,692 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:20:09,337 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:20:09,346 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.65s
2025-04-20 16:20:09,346 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:20:09,346 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:20:09,346 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:20:09,346 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:20:09,346 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:20:09,346 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:20:09,346 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:20:09,346 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:20:09,346 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:20:09,346 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:20:09,346 - main - INFO - City-based scanning skipped
2025-04-20 16:20:09,346 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:20:09,346 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:20:09,350 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:20:09,350 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:25:09,355 - main - INFO - Starting new scan cycle...
2025-04-20 16:25:09,362 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:25:09,362 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:25:10,376 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:25:10,377 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:25:10,384 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.02s
2025-04-20 16:25:10,384 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:25:10,384 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:25:10,384 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:25:10,384 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:25:10,384 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:25:10,385 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:25:10,385 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:25:10,385 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:25:10,385 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:25:10,385 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:25:10,385 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:25:11,579 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:25:11,585 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.20s
2025-04-20 16:25:11,585 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:25:11,585 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:25:11,585 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:25:11,585 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:25:11,585 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:25:11,586 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:25:11,586 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:25:11,586 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:25:11,586 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:25:11,586 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:25:11,586 - main - INFO - City-based scanning skipped
2025-04-20 16:25:11,586 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:25:11,586 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:25:11,588 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:25:11,588 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:28:44,808 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 16:28:47,141 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 16:28:47.141151
2025-04-20 16:28:47,189 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 16:28:47,189 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 16:28:47,190 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:28:47,196 - database.migrations - INFO - Database initialized successfully
2025-04-20 16:28:47,203 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 16:28:47,203 - main - INFO - Starting new scan cycle...
2025-04-20 16:28:47,205 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:28:47,206 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:28:48,559 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:28:48,560 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:28:48,848 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.64s
2025-04-20 16:28:48,864 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:28:48,866 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:28:48,866 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:28:48,866 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:28:48,866 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:28:48,866 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:28:48,866 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:28:48,866 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:28:48,866 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:28:48,866 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:28:48,867 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:28:49,631 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:28:49,651 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.78s
2025-04-20 16:28:49,651 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:28:49,651 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:28:49,651 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:28:49,651 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:28:49,651 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:28:49,651 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:28:49,651 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:28:49,651 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:28:49,653 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:28:49,653 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:28:49,653 - main - INFO - City-based scanning skipped
2025-04-20 16:28:49,653 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:28:49,653 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:28:49,686 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:28:49,686 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:33:49,691 - main - INFO - Starting new scan cycle...
2025-04-20 16:33:49,701 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:33:49,701 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:33:50,527 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 16:33:50,528 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:33:50,528 - utils.http - INFO - Anti-bot retry 1/3 using Firefox Linux profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down", waiting 4.5 seconds...
2025-04-20 16:33:56,263 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:33:56,267 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:33:56,268 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:33:56,284 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 6.58s
2025-04-20 16:33:56,284 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:33:56,284 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:33:56,284 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:33:56,284 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:33:56,284 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:33:56,284 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:33:56,284 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:33:56,284 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:33:56,285 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:33:56,285 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:33:56,285 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:33:57,032 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:33:57,045 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.76s
2025-04-20 16:33:57,045 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:33:57,045 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:33:57,045 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:33:57,045 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:33:57,045 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:33:57,045 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:33:57,045 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:33:57,045 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:33:57,045 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:33:57,045 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:33:57,045 - main - INFO - City-based scanning skipped
2025-04-20 16:33:57,045 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:33:57,045 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:33:57,049 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:33:57,049 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:38:57,053 - main - INFO - Starting new scan cycle...
2025-04-20 16:38:57,058 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:38:57,058 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:38:57,930 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:38:57,931 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:38:57,935 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 0.88s
2025-04-20 16:38:57,936 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:38:57,936 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:38:57,936 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:38:57,936 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:38:57,936 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:38:57,936 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:38:57,936 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:38:57,936 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:38:57,936 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:38:57,936 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:38:57,936 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:38:58,629 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:38:58,634 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.70s
2025-04-20 16:38:58,634 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:38:58,634 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:38:58,634 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:38:58,634 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:38:58,634 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:38:58,634 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:38:58,634 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:38:58,634 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:38:58,634 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:38:58,634 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:38:58,634 - main - INFO - City-based scanning skipped
2025-04-20 16:38:58,634 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:38:58,634 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:38:58,636 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:38:58,636 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:43:38,989 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 16:43:48,371 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 16:43:48.371410
2025-04-20 16:43:48,389 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 16:43:48,389 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 16:43:48,389 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:43:48,396 - database.migrations - INFO - Database initialized successfully
2025-04-20 16:43:48,403 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 16:43:48,404 - main - INFO - Starting new scan cycle...
2025-04-20 16:43:48,413 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:43:48,414 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:43:50,636 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:43:50,637 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:43:50,696 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 2.28s
2025-04-20 16:43:50,696 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:43:50,696 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:43:50,696 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:43:50,696 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:43:50,696 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:43:50,696 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:43:50,696 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:43:50,696 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:43:50,696 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:43:50,696 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:43:50,696 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:43:51,641 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:43:51,696 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.00s
2025-04-20 16:43:51,696 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:43:51,696 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:43:51,696 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:43:51,696 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:43:51,696 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:43:51,696 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:43:51,696 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:43:51,696 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:43:51,696 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:43:51,696 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:43:51,696 - main - INFO - City-based scanning skipped
2025-04-20 16:43:51,696 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:43:51,696 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:43:51,702 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:43:51,702 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:48:51,707 - main - INFO - Starting new scan cycle...
2025-04-20 16:48:51,718 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:48:51,718 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:48:52,197 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 16:48:52,198 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:48:52,198 - utils.http - INFO - Anti-bot retry 1/3 using Firefox Linux profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down", waiting 2.9 seconds...
2025-04-20 16:48:55,840 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:48:55,843 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:48:55,844 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:48:55,858 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 4.14s
2025-04-20 16:48:55,858 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:48:55,858 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:48:55,858 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:48:55,858 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:48:55,858 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:48:55,858 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:48:55,858 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:48:55,858 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:48:55,858 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:48:55,858 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:48:55,858 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:48:56,772 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:48:56,788 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.93s
2025-04-20 16:48:56,788 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:48:56,788 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:48:56,788 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:48:56,788 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:48:56,788 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:48:56,789 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:48:56,789 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:48:56,789 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:48:56,789 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:48:56,789 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:48:56,789 - main - INFO - City-based scanning skipped
2025-04-20 16:48:56,789 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:48:56,789 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:48:56,791 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:48:56,791 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:53:56,797 - main - INFO - Starting new scan cycle...
2025-04-20 16:53:56,805 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:53:56,806 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:53:57,957 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:53:57,958 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:53:57,966 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.16s
2025-04-20 16:53:57,966 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:53:57,966 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:53:57,967 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:53:57,967 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:53:57,967 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:53:57,967 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:53:57,967 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:53:57,967 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:53:57,967 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:53:57,967 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:53:57,967 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:53:58,757 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:53:58,768 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.80s
2025-04-20 16:53:58,768 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:53:58,768 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:53:58,768 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:53:58,768 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:53:58,768 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:53:58,768 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:53:58,768 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:53:58,768 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:53:58,768 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:53:58,768 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:53:58,769 - main - INFO - City-based scanning skipped
2025-04-20 16:53:58,769 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:53:58,769 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:53:58,772 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:53:58,772 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 16:57:08,963 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 16:57:11,957 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 16:57:11.957275
2025-04-20 16:57:12,184 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 16:57:12,187 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 16:57:12,189 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:57:12,202 - database.migrations - INFO - Database initialized successfully
2025-04-20 16:57:12,216 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 16:57:12,217 - main - INFO - Starting new scan cycle...
2025-04-20 16:57:12,221 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 16:57:12,221 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 16:57:13,457 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 16:57:13,459 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 16:57:13,566 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.32s
2025-04-20 16:57:13,566 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:57:13,566 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 16:57:13,566 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 16:57:13,567 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 16:57:13,567 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 16:57:13,567 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 16:57:13,567 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 16:57:13,567 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 16:57:13,567 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 16:57:13,567 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 16:57:13,567 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 16:57:14,510 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 16:57:14,551 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.98s
2025-04-20 16:57:14,551 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 16:57:14,551 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 16:57:14,551 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 16:57:14,551 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 16:57:14,551 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 16:57:14,551 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 16:57:14,552 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 16:57:14,552 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 16:57:14,552 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 16:57:14,552 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 16:57:14,552 - main - INFO - City-based scanning skipped
2025-04-20 16:57:14,552 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 16:57:14,552 - main - INFO - Detecting potential duplicate listings...
2025-04-20 16:57:14,581 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 16:57:14,581 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:02:14,588 - main - INFO - Starting new scan cycle...
2025-04-20 17:02:14,602 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:02:14,602 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:02:15,869 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:02:15,870 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:02:15,885 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.28s
2025-04-20 17:02:15,885 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:02:15,885 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:02:15,885 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:02:15,885 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:02:15,885 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:02:15,885 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:02:15,885 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:02:15,885 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:02:15,885 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:02:15,885 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:02:15,885 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:02:17,179 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:02:17,192 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.31s
2025-04-20 17:02:17,192 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:02:17,192 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:02:17,192 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:02:17,192 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:02:17,192 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:02:17,192 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:02:17,193 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:02:17,193 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:02:17,193 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:02:17,193 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:02:17,193 - main - INFO - City-based scanning skipped
2025-04-20 17:02:17,193 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:02:17,193 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:02:17,195 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:02:17,195 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:02:40,618 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:02:43,035 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:02:43.035634
2025-04-20 17:02:43,100 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:02:43,100 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:02:43,101 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:02:43,108 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:02:43,115 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:02:43,115 - main - INFO - Starting new scan cycle...
2025-04-20 17:02:43,118 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:02:43,118 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:02:44,150 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:02:44,152 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:02:44,422 - database.telegram_db - ERROR - Error adding matched properties to queue: invalid input syntax for type integer: " 1.995 /maand"
CONTEXT:  unnamed portal parameter $3 = '...'
2025-04-20 17:02:44,448 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 17:02:44,476 - database.telegram_db - ERROR - Error adding matched properties to queue: invalid input syntax for type integer: " 2.325 /maand"
CONTEXT:  unnamed portal parameter $3 = '...'
2025-04-20 17:02:44,476 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 17:02:44,491 - database.telegram_db - ERROR - Error adding matched properties to queue: invalid input syntax for type integer: " 2.425 /maand"
CONTEXT:  unnamed portal parameter $3 = '...'
2025-04-20 17:02:44,494 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 17:02:44,496 - main - INFO - Completed scan of query URL (ID=1): 3 new, 4 total in 1.38s
2025-04-20 17:02:44,506 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:02:45,403 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 17:02:45,406 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 0.89s
2025-04-20 17:02:45,406 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 17:02:45,406 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:02:45,406 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:02:45,406 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:02:45,406 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:02:45,406 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:02:45,406 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:02:45,406 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:02:45,406 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:02:45,406 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:02:46,196 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:02:46,201 - database.telegram_db - ERROR - Error adding matched properties to queue: invalid input syntax for type integer: "470 per month"
CONTEXT:  unnamed portal parameter $3 = '...'
2025-04-20 17:02:46,201 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 17:02:46,206 - database.telegram_db - ERROR - Error adding matched properties to queue: invalid input syntax for type integer: "950 per month"
CONTEXT:  unnamed portal parameter $3 = '...'
2025-04-20 17:02:46,206 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 17:02:46,208 - database.telegram_db - ERROR - Error adding matched properties to queue: invalid input syntax for type integer: "2,500 per month"
CONTEXT:  unnamed portal parameter $3 = '...'
2025-04-20 17:02:46,209 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 17:02:46,212 - database.telegram_db - ERROR - Error adding matched properties to queue: invalid input syntax for type integer: "896 per month"
CONTEXT:  unnamed portal parameter $3 = '...'
2025-04-20 17:02:46,212 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 17:02:46,213 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.81s
2025-04-20 17:02:46,213 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 17:02:47,287 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:02:47,299 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.08s
2025-04-20 17:02:47,299 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:02:47,299 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:02:47,299 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:02:47,299 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:02:47,299 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:02:47,299 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:02:47,299 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:02:47,299 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:02:47,299 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:02:47,299 - main - INFO - City-based scanning skipped
2025-04-20 17:02:47,299 - main - INFO - Scan complete: 7 new listings from 12 total processed
2025-04-20 17:02:47,299 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:02:47,305 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:02:47,305 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:07:20,719 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:07:24,708 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:07:24.708972
2025-04-20 17:07:24,790 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:07:24,801 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:07:24,804 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:07:24,812 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:07:24,824 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:07:24,824 - main - INFO - Starting new scan cycle...
2025-04-20 17:07:24,828 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:07:24,828 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:07:26,042 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:07:26,043 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:07:26,091 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.26s
2025-04-20 17:07:26,091 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:07:26,091 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:07:26,091 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:07:26,091 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:07:26,091 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:07:26,091 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:07:26,091 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:07:26,091 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:07:26,091 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:07:26,091 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:07:26,091 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:07:27,106 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:07:27,119 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.03s
2025-04-20 17:07:27,119 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:07:27,119 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:07:27,119 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:07:27,119 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:07:27,120 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:07:27,120 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:07:27,120 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:07:27,120 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:07:27,120 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:07:27,120 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:07:27,120 - main - INFO - City-based scanning skipped
2025-04-20 17:07:27,120 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:07:27,120 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:07:27,128 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:07:27,128 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:07:37,064 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:07:38,441 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:07:38.441678
2025-04-20 17:07:38,464 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:07:38,464 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:07:38,464 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:07:38,471 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:07:38,478 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:07:38,478 - main - INFO - Starting new scan cycle...
2025-04-20 17:07:38,481 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:07:38,481 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:07:39,325 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:07:39,327 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:07:39,375 - database.telegram_db - INFO - Property data for id 1588: (1588, 'funda', '43980716', 'b607b260a805e2367d45e808389b5156', 'https://www.funda.nl/detail/huur/wezep/huis-turfhorst-4-a/43980716/', 'Turfhorst 4-A', 'Turfhorst 4-A', '8091 EH', 'WEZEP', None, ' 2.700 /maand', 2700.0, 'month', None, None, 'house', 'rental', 220, None, None, 5, None, None, None, None, None, None, None, 'A++', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 7, 39, 330203, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/561/627.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:07:39,377 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1588: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:07:39,377 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 17:07:39,378 - database.telegram_db - INFO - Property data for id 1589: (1589, 'funda', '43980657', '634138d3018a2f857d08c8b7ce4f90df', 'https://www.funda.nl/detail/huur/den-haag/appartement-parelmoerhorst-14/43980657/', 'Parelmoerhorst 14', 'Parelmoerhorst 14', '2592 SE', 'DEN HAAG', None, ' 1.995 /maand', 1995.0, 'month', None, None, 'apartment', 'rental', 91, None, None, 2, None, None, None, None, None, None, None, 'B', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 7, 39, 377618, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/558/773.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:07:39,379 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1589: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:07:39,379 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 17:07:39,380 - database.telegram_db - INFO - Property data for id 1590: (1590, 'funda', '43988117', 'fc313c657088cd2d69963e230e15169b', 'https://www.funda.nl/detail/huur/amsterdam/appartement-gelrestraat-51/43988117/', 'Gelrestraat 51', 'Gelrestraat 51', '1079 MZ', 'AMSTERDAM', None, ' 2.325 /maand', 2325.0, 'month', None, None, 'apartment', 'rental', 65, None, None, 2, None, None, None, None, None, None, None, 'A', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 7, 39, 379324, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/490/023.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:07:39,380 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1590: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:07:39,380 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 17:07:39,382 - database.telegram_db - INFO - Property data for id 1591: (1591, 'funda', '43988107', '8e6c44d5f97b2eaf80c2e3c2a7598211', 'https://www.funda.nl/detail/huur/amsterdam/appartement-carnapstraat-70/43988107/', 'Carnapstraat 70', 'Carnapstraat 70', '1062 KT', 'AMSTERDAM', None, ' 2.425 /maand', 2425.0, 'month', None, None, 'apartment', 'rental', 92, None, None, 2, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 7, 39, 381201, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/489/636.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:07:39,382 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1591: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:07:39,382 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 17:07:39,383 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 0.90s
2025-04-20 17:07:39,383 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:07:40,578 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 17:07:40,581 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 1.19s
2025-04-20 17:07:40,581 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 17:07:40,581 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:07:40,581 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:07:40,581 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:07:40,581 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:07:40,581 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:07:40,581 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:07:40,581 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:07:40,581 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:07:40,581 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:07:41,762 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:07:41,764 - database.telegram_db - INFO - Property data for id 1592: (1592, 'pararius', 'decbf94e', '5737486fec4ea7433fec7cfe6e07420f', 'https://www.pararius.com/room-for-rent/tilburg/decbf94e/veestraat', 'Room Veestraat', 'Veestraat', '5021 PT', 'TILBURG', 'Zeeheldenbuurt', '470 per month', 470.0, 'month', None, None, 'room', 'rental', 18, None, None, 1, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 7, 41, 762932, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/decbf94e-5876-5ed2-9a9f-309dd19409da/8c101a34fd19313ef54a9ad798b2a8c1.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:07:41,765 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1592: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:07:41,765 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 17:07:41,767 - database.telegram_db - INFO - Property data for id 1593: (1593, 'pararius', '35565540', '4099dd69b612fce3ebee378168ed624c', 'https://www.pararius.com/apartment-for-rent/bergen-op-zoom/35565540/steenbergsestraat', 'Flat Steenbergsestraat', 'Steenbergsestraat', '4611 TC', 'BERGEN OP ZOOM', 'Centrum', '950 per month', 950.0, 'month', None, None, 'apartment', 'rental', 50, None, None, 2, 1, None, None, None, None, None, None, None, 'upholstered', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 7, 41, 765595, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/35565540-ba22-5d40-a665-dbd095ea79fd/a49c5639a3af92848967ed61d2800098.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:07:41,767 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1593: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:07:41,767 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 17:07:41,769 - database.telegram_db - INFO - Property data for id 1594: (1594, 'pararius', '0dee4b1a', 'b4c130e9de42bd785307b926ebff8117', 'https://www.pararius.com/apartment-for-rent/amsterdam/0dee4b1a/hoofdweg', 'Flat Hoofdweg 604', 'Hoofdweg 604', '1055 AB', 'AMSTERDAM', 'Erasmuspark', '2,500 per month', 2500.0, 'month', None, None, 'apartment', 'rental', 93, None, None, 3, 2, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 7, 41, 767982, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/0dee4b1a-a781-57d4-9dad-2021b795737c/4cf40a0e10d856bf63ef4b1528a764b4.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:07:41,769 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1594: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:07:41,769 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 17:07:41,771 - database.telegram_db - INFO - Property data for id 1595: (1595, 'pararius', '1e58e653', '179e9065c0eff96ed8492c80c3f2fdd4', 'https://www.pararius.com/apartment-for-rent/maastricht/1e58e653/endepolsdomein', 'Flat Endepolsdomein', 'Endepolsdomein', '6229 EM', 'MAASTRICHT', 'Randwyck', '896 per month', 896.0, 'month', None, None, 'apartment', 'rental', 25, None, None, 1, None, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 7, 41, 769995, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/1e58e653-438c-54e7-aabf-c009fed469a4/4bdc3bb92e19aa053fd4d01b5a801c0b.webp?width=600&auto=webp'], {}, None)
2025-04-20 17:07:41,771 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1595: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:07:41,771 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 17:07:41,772 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.19s
2025-04-20 17:07:41,772 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 17:07:42,916 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:07:42,921 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.15s
2025-04-20 17:07:42,921 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:07:42,921 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:07:42,921 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:07:42,921 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:07:42,921 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:07:42,921 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:07:42,921 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:07:42,921 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:07:42,921 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:07:42,921 - main - INFO - City-based scanning skipped
2025-04-20 17:07:42,921 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 17:07:42,921 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:07:42,934 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:07:42,934 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:12:42,941 - main - INFO - Starting new scan cycle...
2025-04-20 17:12:42,952 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:12:42,953 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:12:43,856 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:12:43,857 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:12:43,873 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 0.92s
2025-04-20 17:12:43,873 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:12:43,874 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:12:43,874 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:12:43,874 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:12:43,874 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:12:43,874 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:12:43,874 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:12:43,874 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:12:43,874 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:12:43,874 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:12:43,874 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:12:45,049 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:12:45,060 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.18s
2025-04-20 17:12:45,060 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:12:45,060 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:12:45,060 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:12:45,060 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:12:45,060 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:12:45,060 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:12:45,060 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:12:45,061 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:12:45,061 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:12:45,061 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:12:45,061 - main - INFO - City-based scanning skipped
2025-04-20 17:12:45,061 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:12:45,061 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:12:45,063 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:12:45,063 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:17:45,070 - main - INFO - Starting new scan cycle...
2025-04-20 17:17:45,077 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:17:45,078 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:17:45,714 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 17:17:45,714 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:17:45,715 - utils.http - INFO - Anti-bot retry 1/3 using Firefox Windows profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down", waiting 2.5 seconds...
2025-04-20 17:17:49,803 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:17:49,805 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:17:49,806 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:17:49,817 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 4.74s
2025-04-20 17:17:49,817 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:17:49,817 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:17:49,817 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:17:49,817 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:17:49,817 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:17:49,817 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:17:49,817 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:17:49,817 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:17:49,817 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:17:49,817 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:17:49,817 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:17:50,749 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:17:50,758 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.94s
2025-04-20 17:17:50,758 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:17:50,758 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:17:50,758 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:17:50,758 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:17:50,758 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:17:50,758 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:17:50,758 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:17:50,758 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:17:50,758 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:17:50,758 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:17:50,758 - main - INFO - City-based scanning skipped
2025-04-20 17:17:50,758 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:17:50,758 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:17:50,760 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:17:50,760 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:22:50,766 - main - INFO - Starting new scan cycle...
2025-04-20 17:22:50,776 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:22:50,776 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:22:51,246 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 17:22:51,246 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:22:51,247 - utils.http - INFO - Anti-bot retry 1/3 using Firefox Windows profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down", waiting 4.7 seconds...
2025-04-20 17:22:56,969 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:22:56,972 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:22:56,973 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:22:56,982 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 6.20s
2025-04-20 17:22:56,983 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:22:56,983 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:22:56,983 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:22:56,983 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:22:56,983 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:22:56,983 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:22:56,983 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:22:56,983 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:22:56,983 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:22:56,983 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:22:56,983 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:22:58,047 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:22:58,054 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.07s
2025-04-20 17:22:58,054 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:22:58,054 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:22:58,054 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:22:58,054 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:22:58,054 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:22:58,055 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:22:58,055 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:22:58,055 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:22:58,055 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:22:58,055 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:22:58,055 - main - INFO - City-based scanning skipped
2025-04-20 17:22:58,055 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:22:58,055 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:22:58,056 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:22:58,057 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:24:53,842 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:25:15,049 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:25:15.049374
2025-04-20 17:25:15,168 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:25:15,168 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:25:15,169 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:25:15,182 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:25:15,190 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:25:15,191 - main - INFO - Starting new scan cycle...
2025-04-20 17:25:15,193 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:25:15,194 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:25:16,292 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:25:16,293 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:25:16,341 - database.telegram_db - INFO - Property data for id 1596: (1596, 'funda', '43980716', 'b607b260a805e2367d45e808389b5156', 'https://www.funda.nl/detail/huur/wezep/huis-turfhorst-4-a/43980716/', 'Turfhorst 4-A', 'Turfhorst 4-A', '8091 EH', 'WEZEP', None, ' 2.700 /maand', 2700.0, 'month', None, None, 'house', 'rental', 220, None, None, 5, None, None, None, None, None, None, None, 'A++', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 25, 16, 296027, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/561/627.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:25:16,343 - database.telegram_db - INFO - Property type: None
2025-04-20 17:25:16,343 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1596: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:25:16,343 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 17:25:16,344 - database.telegram_db - INFO - Property data for id 1597: (1597, 'funda', '43980657', '634138d3018a2f857d08c8b7ce4f90df', 'https://www.funda.nl/detail/huur/den-haag/appartement-parelmoerhorst-14/43980657/', 'Parelmoerhorst 14', 'Parelmoerhorst 14', '2592 SE', 'DEN HAAG', None, ' 1.995 /maand', 1995.0, 'month', None, None, 'apartment', 'rental', 91, None, None, 2, None, None, None, None, None, None, None, 'B', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 25, 16, 343722, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/558/773.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:25:16,345 - database.telegram_db - INFO - Property type: None
2025-04-20 17:25:16,345 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1597: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:25:16,345 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 17:25:16,346 - database.telegram_db - INFO - Property data for id 1598: (1598, 'funda', '43988117', 'fc313c657088cd2d69963e230e15169b', 'https://www.funda.nl/detail/huur/amsterdam/appartement-gelrestraat-51/43988117/', 'Gelrestraat 51', 'Gelrestraat 51', '1079 MZ', 'AMSTERDAM', None, ' 2.325 /maand', 2325.0, 'month', None, None, 'apartment', 'rental', 65, None, None, 2, None, None, None, None, None, None, None, 'A', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 25, 16, 345772, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/490/023.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:25:16,347 - database.telegram_db - INFO - Property type: None
2025-04-20 17:25:16,347 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1598: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:25:16,347 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 17:25:16,348 - database.telegram_db - INFO - Property data for id 1599: (1599, 'funda', '43988107', '8e6c44d5f97b2eaf80c2e3c2a7598211', 'https://www.funda.nl/detail/huur/amsterdam/appartement-carnapstraat-70/43988107/', 'Carnapstraat 70', 'Carnapstraat 70', '1062 KT', 'AMSTERDAM', None, ' 2.425 /maand', 2425.0, 'month', None, None, 'apartment', 'rental', 92, None, None, 2, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 25, 16, 347674, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/489/636.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:25:16,349 - database.telegram_db - INFO - Property type: None
2025-04-20 17:25:16,349 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1599: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:25:16,349 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 17:25:16,350 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.16s
2025-04-20 17:25:16,350 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:25:17,034 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 17:25:17,035 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:25:17,035 - utils.http - INFO - Anti-bot retry 1/3 using Chrome Windows profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down", waiting 2.0 seconds...
2025-04-20 17:25:20,706 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:25:20,707 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 17:25:20,709 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 4.36s
2025-04-20 17:25:20,709 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 17:25:20,709 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:25:20,709 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:25:20,709 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:25:20,709 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:25:20,709 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:25:20,709 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:25:20,709 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:25:20,709 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:25:20,709 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:25:21,810 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:25:21,814 - database.telegram_db - INFO - Property data for id 1600: (1600, 'pararius', 'decbf94e', '5737486fec4ea7433fec7cfe6e07420f', 'https://www.pararius.com/room-for-rent/tilburg/decbf94e/veestraat', 'Room Veestraat', 'Veestraat', '5021 PT', 'TILBURG', 'Zeeheldenbuurt', '470 per month', 470.0, 'month', None, None, 'room', 'rental', 18, None, None, 1, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 25, 21, 811491, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/decbf94e-5876-5ed2-9a9f-309dd19409da/8c101a34fd19313ef54a9ad798b2a8c1.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:25:21,814 - database.telegram_db - INFO - Property type: None
2025-04-20 17:25:21,814 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1600: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:25:21,815 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 17:25:21,818 - database.telegram_db - INFO - Property data for id 1601: (1601, 'pararius', '35565540', '4099dd69b612fce3ebee378168ed624c', 'https://www.pararius.com/apartment-for-rent/bergen-op-zoom/35565540/steenbergsestraat', 'Flat Steenbergsestraat', 'Steenbergsestraat', '4611 TC', 'BERGEN OP ZOOM', 'Centrum', '950 per month', 950.0, 'month', None, None, 'apartment', 'rental', 50, None, None, 2, 1, None, None, None, None, None, None, None, 'upholstered', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 25, 21, 815575, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/35565540-ba22-5d40-a665-dbd095ea79fd/a49c5639a3af92848967ed61d2800098.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:25:21,819 - database.telegram_db - INFO - Property type: None
2025-04-20 17:25:21,819 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1601: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:25:21,819 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 17:25:21,821 - database.telegram_db - INFO - Property data for id 1602: (1602, 'pararius', '0dee4b1a', 'b4c130e9de42bd785307b926ebff8117', 'https://www.pararius.com/apartment-for-rent/amsterdam/0dee4b1a/hoofdweg', 'Flat Hoofdweg 604', 'Hoofdweg 604', '1055 AB', 'AMSTERDAM', 'Erasmuspark', '2,500 per month', 2500.0, 'month', None, None, 'apartment', 'rental', 93, None, None, 3, 2, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 25, 21, 819572, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/0dee4b1a-a781-57d4-9dad-2021b795737c/4cf40a0e10d856bf63ef4b1528a764b4.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:25:21,822 - database.telegram_db - INFO - Property type: None
2025-04-20 17:25:21,822 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1602: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:25:21,822 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 17:25:21,825 - database.telegram_db - INFO - Property data for id 1603: (1603, 'pararius', '1e58e653', '179e9065c0eff96ed8492c80c3f2fdd4', 'https://www.pararius.com/apartment-for-rent/maastricht/1e58e653/endepolsdomein', 'Flat Endepolsdomein', 'Endepolsdomein', '6229 EM', 'MAASTRICHT', 'Randwyck', '896 per month', 896.0, 'month', None, None, 'apartment', 'rental', 25, None, None, 1, None, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 25, 21, 823128, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/1e58e653-438c-54e7-aabf-c009fed469a4/4bdc3bb92e19aa053fd4d01b5a801c0b.webp?width=600&auto=webp'], {}, None)
2025-04-20 17:25:21,826 - database.telegram_db - INFO - Property type: None
2025-04-20 17:25:21,826 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1603: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:25:21,826 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 17:25:21,827 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.12s
2025-04-20 17:25:21,827 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 17:25:22,480 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:25:22,486 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 0.66s
2025-04-20 17:25:22,486 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:25:22,486 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:25:22,486 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:25:22,486 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:25:22,486 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:25:22,486 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:25:22,486 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:25:22,486 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:25:22,486 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:25:22,486 - main - INFO - City-based scanning skipped
2025-04-20 17:25:22,486 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 17:25:22,486 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:25:22,495 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:25:22,495 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:30:22,501 - main - INFO - Starting new scan cycle...
2025-04-20 17:30:22,509 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:30:22,509 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:30:23,385 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 17:30:23,385 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:30:23,386 - utils.http - INFO - Anti-bot retry 1/3 using Chrome Windows profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down", waiting 2.5 seconds...
2025-04-20 17:30:26,894 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:30:26,897 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:30:26,898 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:30:26,913 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 4.40s
2025-04-20 17:30:26,913 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:30:26,913 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:30:26,913 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:30:26,913 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:30:26,914 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:30:26,914 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:30:26,914 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:30:26,914 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:30:26,914 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:30:26,914 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:30:26,914 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:30:28,245 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:30:28,257 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.34s
2025-04-20 17:30:28,257 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:30:28,257 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:30:28,257 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:30:28,257 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:30:28,258 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:30:28,258 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:30:28,258 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:30:28,258 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:30:28,258 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:30:28,258 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:30:28,258 - main - INFO - City-based scanning skipped
2025-04-20 17:30:28,258 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:30:28,258 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:30:28,261 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:30:28,261 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:35:04,901 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:35:07,772 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:35:07.772331
2025-04-20 17:35:07,891 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:35:07,898 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:35:07,899 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:35:07,909 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:35:07,921 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:35:07,922 - main - INFO - Starting new scan cycle...
2025-04-20 17:35:07,924 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:35:07,925 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:35:08,931 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:35:08,933 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:35:09,199 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.25s
2025-04-20 17:35:09,200 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:35:09,200 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:35:09,200 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:35:09,200 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:35:09,200 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:35:09,200 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:35:09,200 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:35:09,200 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:35:09,200 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:35:09,200 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:35:09,201 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:35:10,452 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:35:10,463 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.26s
2025-04-20 17:35:10,463 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:35:10,463 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:35:10,463 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:35:10,463 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:35:10,463 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:35:10,463 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:35:10,463 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:35:10,463 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:35:10,463 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:35:10,463 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:35:10,463 - main - INFO - City-based scanning skipped
2025-04-20 17:35:10,463 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:35:10,464 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:35:10,470 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:35:10,470 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:35:12,247 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:35:43,185 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:35:43.185876
2025-04-20 17:35:43,210 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:35:43,210 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:35:43,211 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:35:44,298 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:35:44,308 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:35:44,308 - main - INFO - Starting new scan cycle...
2025-04-20 17:35:44,310 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:35:44,310 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:35:45,169 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:35:45,170 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:35:45,220 - database.telegram_db - INFO - Property data for id 1604: (1604, 'funda', '43980716', 'b607b260a805e2367d45e808389b5156', 'https://www.funda.nl/detail/huur/wezep/huis-turfhorst-4-a/43980716/', 'Turfhorst 4-A', 'Turfhorst 4-A', '8091 EH', 'WEZEP', None, ' 2.700 /maand', 2700.0, 'month', None, None, 'house', 'rental', 220, None, None, 5, None, None, None, None, None, None, None, 'A++', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 35, 45, 173793, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/561/627.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:35:45,221 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1604: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:35:45,221 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 17:35:45,223 - database.telegram_db - INFO - Property data for id 1605: (1605, 'funda', '43980657', '634138d3018a2f857d08c8b7ce4f90df', 'https://www.funda.nl/detail/huur/den-haag/appartement-parelmoerhorst-14/43980657/', 'Parelmoerhorst 14', 'Parelmoerhorst 14', '2592 SE', 'DEN HAAG', None, ' 1.995 /maand', 1995.0, 'month', None, None, 'apartment', 'rental', 91, None, None, 2, None, None, None, None, None, None, None, 'B', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 35, 45, 222207, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/558/773.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:35:45,223 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1605: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:35:45,223 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 17:35:45,224 - database.telegram_db - INFO - Property data for id 1606: (1606, 'funda', '43988117', 'fc313c657088cd2d69963e230e15169b', 'https://www.funda.nl/detail/huur/amsterdam/appartement-gelrestraat-51/43988117/', 'Gelrestraat 51', 'Gelrestraat 51', '1079 MZ', 'AMSTERDAM', None, ' 2.325 /maand', 2325.0, 'month', None, None, 'apartment', 'rental', 65, None, None, 2, None, None, None, None, None, None, None, 'A', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 35, 45, 224030, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/490/023.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:35:45,225 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1606: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:35:45,225 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 17:35:45,226 - database.telegram_db - INFO - Property data for id 1607: (1607, 'funda', '43988107', '8e6c44d5f97b2eaf80c2e3c2a7598211', 'https://www.funda.nl/detail/huur/amsterdam/appartement-carnapstraat-70/43988107/', 'Carnapstraat 70', 'Carnapstraat 70', '1062 KT', 'AMSTERDAM', None, ' 2.425 /maand', 2425.0, 'month', None, None, 'apartment', 'rental', 92, None, None, 2, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 35, 45, 225579, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/489/636.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:35:45,227 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1607: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:35:45,227 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 17:35:45,228 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 0.92s
2025-04-20 17:35:45,228 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:35:45,850 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 17:35:45,850 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:35:45,850 - utils.http - INFO - Anti-bot retry 1/3 using Mobile Chrome Android profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down", waiting 3.2 seconds...
2025-04-20 17:35:50,286 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:35:50,288 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 17:35:50,290 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 5.06s
2025-04-20 17:35:50,290 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 17:35:50,290 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:35:50,290 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:35:50,290 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:35:50,290 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:35:50,290 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:35:50,290 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:35:50,290 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:35:50,290 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:35:50,290 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:35:50,993 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:35:50,996 - database.telegram_db - INFO - Property data for id 1608: (1608, 'pararius', 'decbf94e', '5737486fec4ea7433fec7cfe6e07420f', 'https://www.pararius.com/room-for-rent/tilburg/decbf94e/veestraat', 'Room Veestraat', 'Veestraat', '5021 PT', 'TILBURG', 'Zeeheldenbuurt', '470 per month', 470.0, 'month', None, None, 'room', 'rental', 18, None, None, 1, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 35, 50, 994175, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/decbf94e-5876-5ed2-9a9f-309dd19409da/8c101a34fd19313ef54a9ad798b2a8c1.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:35:50,996 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1608: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:35:50,996 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 17:35:50,999 - database.telegram_db - INFO - Property data for id 1609: (1609, 'pararius', '35565540', '4099dd69b612fce3ebee378168ed624c', 'https://www.pararius.com/apartment-for-rent/bergen-op-zoom/35565540/steenbergsestraat', 'Flat Steenbergsestraat', 'Steenbergsestraat', '4611 TC', 'BERGEN OP ZOOM', 'Centrum', '950 per month', 950.0, 'month', None, None, 'apartment', 'rental', 50, None, None, 2, 1, None, None, None, None, None, None, None, 'upholstered', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 35, 50, 997429, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/35565540-ba22-5d40-a665-dbd095ea79fd/a49c5639a3af92848967ed61d2800098.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:35:50,999 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1609: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:35:50,999 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 17:35:51,001 - database.telegram_db - INFO - Property data for id 1610: (1610, 'pararius', '0dee4b1a', 'b4c130e9de42bd785307b926ebff8117', 'https://www.pararius.com/apartment-for-rent/amsterdam/0dee4b1a/hoofdweg', 'Flat Hoofdweg 604', 'Hoofdweg 604', '1055 AB', 'AMSTERDAM', 'Erasmuspark', '2,500 per month', 2500.0, 'month', None, None, 'apartment', 'rental', 93, None, None, 3, 2, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 35, 50, 999754, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/0dee4b1a-a781-57d4-9dad-2021b795737c/4cf40a0e10d856bf63ef4b1528a764b4.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:35:51,001 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1610: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:35:51,001 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 17:35:51,003 - database.telegram_db - INFO - Property data for id 1611: (1611, 'pararius', '1e58e653', '179e9065c0eff96ed8492c80c3f2fdd4', 'https://www.pararius.com/apartment-for-rent/maastricht/1e58e653/endepolsdomein', 'Flat Endepolsdomein', 'Endepolsdomein', '6229 EM', 'MAASTRICHT', 'Randwyck', '896 per month', 896.0, 'month', None, None, 'apartment', 'rental', 25, None, None, 1, None, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 35, 51, 2026, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/1e58e653-438c-54e7-aabf-c009fed469a4/4bdc3bb92e19aa053fd4d01b5a801c0b.webp?width=600&auto=webp'], {}, None)
2025-04-20 17:35:51,004 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1611: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:35:51,004 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 17:35:51,005 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.71s
2025-04-20 17:35:51,005 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 17:35:52,252 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:35:52,263 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.26s
2025-04-20 17:35:52,263 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:35:52,263 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:35:52,263 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:35:52,263 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:35:52,263 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:35:52,263 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:35:52,263 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:35:52,263 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:35:52,263 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:35:52,263 - main - INFO - City-based scanning skipped
2025-04-20 17:35:52,263 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 17:35:52,263 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:35:52,277 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:35:52,277 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:35:57,769 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:36:26,517 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:36:26.517856
2025-04-20 17:36:26,545 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:36:26,545 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:36:26,546 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:36:26,555 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:36:26,563 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:36:26,563 - main - INFO - Starting new scan cycle...
2025-04-20 17:36:26,565 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:36:26,566 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:36:27,551 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:36:27,552 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:36:27,603 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.04s
2025-04-20 17:36:27,603 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:36:27,603 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:36:27,603 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:36:27,603 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:36:27,603 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:36:27,603 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:36:27,603 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:36:27,603 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:36:27,603 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:36:27,603 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:36:27,604 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:36:28,547 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:36:28,555 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.95s
2025-04-20 17:36:28,555 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:36:28,555 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:36:28,555 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:36:28,555 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:36:28,555 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:36:28,555 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:36:28,555 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:36:28,555 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:36:28,555 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:36:28,555 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:36:28,555 - main - INFO - City-based scanning skipped
2025-04-20 17:36:28,555 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:36:28,555 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:36:28,564 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:36:28,564 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:36:29,327 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:36:39,590 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:36:39.590346
2025-04-20 17:36:39,612 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:36:39,612 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:36:39,613 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:36:40,692 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:36:40,699 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:36:40,699 - main - INFO - Starting new scan cycle...
2025-04-20 17:36:40,701 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:36:40,701 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:36:41,870 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:36:41,871 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:36:41,929 - database.telegram_db - INFO - Property data for id 1612: (1612, 'funda', '43980716', 'b607b260a805e2367d45e808389b5156', 'https://www.funda.nl/detail/huur/wezep/huis-turfhorst-4-a/43980716/', 'Turfhorst 4-A', 'Turfhorst 4-A', '8091 EH', 'WEZEP', None, ' 2.700 /maand', 2700.0, 'month', None, None, 'house', 'rental', 220, None, None, 5, None, None, None, None, None, None, None, 'A++', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 36, 41, 874879, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/561/627.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:36:41,930 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1612: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:36:41,930 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 17:36:41,931 - database.telegram_db - INFO - Property data for id 1613: (1613, 'funda', '43980657', '634138d3018a2f857d08c8b7ce4f90df', 'https://www.funda.nl/detail/huur/den-haag/appartement-parelmoerhorst-14/43980657/', 'Parelmoerhorst 14', 'Parelmoerhorst 14', '2592 SE', 'DEN HAAG', None, ' 1.995 /maand', 1995.0, 'month', None, None, 'apartment', 'rental', 91, None, None, 2, None, None, None, None, None, None, None, 'B', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 36, 41, 930675, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/558/773.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:36:41,932 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1613: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:36:41,932 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 17:36:41,933 - database.telegram_db - INFO - Property data for id 1614: (1614, 'funda', '43988117', 'fc313c657088cd2d69963e230e15169b', 'https://www.funda.nl/detail/huur/amsterdam/appartement-gelrestraat-51/43988117/', 'Gelrestraat 51', 'Gelrestraat 51', '1079 MZ', 'AMSTERDAM', None, ' 2.325 /maand', 2325.0, 'month', None, None, 'apartment', 'rental', 65, None, None, 2, None, None, None, None, None, None, None, 'A', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 36, 41, 932518, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/490/023.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:36:41,934 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1614: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:36:41,934 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 17:36:41,935 - database.telegram_db - INFO - Property data for id 1615: (1615, 'funda', '43988107', '8e6c44d5f97b2eaf80c2e3c2a7598211', 'https://www.funda.nl/detail/huur/amsterdam/appartement-carnapstraat-70/43988107/', 'Carnapstraat 70', 'Carnapstraat 70', '1062 KT', 'AMSTERDAM', None, ' 2.425 /maand', 2425.0, 'month', None, None, 'apartment', 'rental', 92, None, None, 2, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 36, 41, 934341, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/489/636.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:36:41,935 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1615: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:36:41,935 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 17:36:41,936 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.23s
2025-04-20 17:36:41,936 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:36:42,879 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 17:36:42,882 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 0.94s
2025-04-20 17:36:42,882 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 17:36:42,882 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:36:42,882 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:36:42,882 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:36:42,882 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:36:42,882 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:36:42,882 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:36:42,882 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:36:42,882 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:36:42,882 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:36:43,521 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:36:43,524 - database.telegram_db - INFO - Property data for id 1616: (1616, 'pararius', 'decbf94e', '5737486fec4ea7433fec7cfe6e07420f', 'https://www.pararius.com/room-for-rent/tilburg/decbf94e/veestraat', 'Room Veestraat', 'Veestraat', '5021 PT', 'TILBURG', 'Zeeheldenbuurt', '470 per month', 470.0, 'month', None, None, 'room', 'rental', 18, None, None, 1, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 36, 43, 522580, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/decbf94e-5876-5ed2-9a9f-309dd19409da/8c101a34fd19313ef54a9ad798b2a8c1.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:36:43,524 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1616: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:36:43,524 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 17:36:43,526 - database.telegram_db - INFO - Property data for id 1617: (1617, 'pararius', '35565540', '4099dd69b612fce3ebee378168ed624c', 'https://www.pararius.com/apartment-for-rent/bergen-op-zoom/35565540/steenbergsestraat', 'Flat Steenbergsestraat', 'Steenbergsestraat', '4611 TC', 'BERGEN OP ZOOM', 'Centrum', '950 per month', 950.0, 'month', None, None, 'apartment', 'rental', 50, None, None, 2, 1, None, None, None, None, None, None, None, 'upholstered', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 36, 43, 525186, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/35565540-ba22-5d40-a665-dbd095ea79fd/a49c5639a3af92848967ed61d2800098.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:36:43,526 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1617: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:36:43,527 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 17:36:43,528 - database.telegram_db - INFO - Property data for id 1618: (1618, 'pararius', '0dee4b1a', 'b4c130e9de42bd785307b926ebff8117', 'https://www.pararius.com/apartment-for-rent/amsterdam/0dee4b1a/hoofdweg', 'Flat Hoofdweg 604', 'Hoofdweg 604', '1055 AB', 'AMSTERDAM', 'Erasmuspark', '2,500 per month', 2500.0, 'month', None, None, 'apartment', 'rental', 93, None, None, 3, 2, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 36, 43, 527283, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/0dee4b1a-a781-57d4-9dad-2021b795737c/4cf40a0e10d856bf63ef4b1528a764b4.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:36:43,528 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1618: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:36:43,528 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 17:36:43,530 - database.telegram_db - INFO - Property data for id 1619: (1619, 'pararius', '1e58e653', '179e9065c0eff96ed8492c80c3f2fdd4', 'https://www.pararius.com/apartment-for-rent/maastricht/1e58e653/endepolsdomein', 'Flat Endepolsdomein', 'Endepolsdomein', '6229 EM', 'MAASTRICHT', 'Randwyck', '896 per month', 896.0, 'month', None, None, 'apartment', 'rental', 25, None, None, 1, None, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 36, 43, 529083, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/1e58e653-438c-54e7-aabf-c009fed469a4/4bdc3bb92e19aa053fd4d01b5a801c0b.webp?width=600&auto=webp'], {}, None)
2025-04-20 17:36:43,530 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1619: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...'
2025-04-20 17:36:43,530 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 17:36:43,531 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.65s
2025-04-20 17:36:43,531 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 17:36:44,794 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:36:44,799 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.27s
2025-04-20 17:36:44,799 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:36:44,799 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:36:44,799 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:36:44,799 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:36:44,800 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:36:44,800 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:36:44,800 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:36:44,800 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:36:44,800 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:36:44,800 - main - INFO - City-based scanning skipped
2025-04-20 17:36:44,800 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 17:36:44,800 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:36:44,813 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:36:44,813 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:38:42,641 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:38:54,683 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:38:54.683647
2025-04-20 17:38:54,706 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:38:54,706 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:38:54,707 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:38:54,714 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:38:54,721 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:38:54,721 - main - INFO - Starting new scan cycle...
2025-04-20 17:38:54,724 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:38:54,724 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:38:55,641 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:38:55,642 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:38:55,689 - database.telegram_db - INFO - Property data for id 1620: (1620, 'funda', '43980716', 'b607b260a805e2367d45e808389b5156', 'https://www.funda.nl/detail/huur/wezep/huis-turfhorst-4-a/43980716/', 'Turfhorst 4-A', 'Turfhorst 4-A', '8091 EH', 'WEZEP', None, ' 2.700 /maand', 2700.0, 'month', None, None, 'house', 'rental', 220, None, None, 5, None, None, None, None, None, None, None, 'A++', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 55, 644973, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/561/627.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:38:55,690 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1620: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...', params: (1620, 'funda', '43980716', 'b607b260a805e2367d45e808389b5156', 'https://www.funda.nl/detail/huur/wezep/huis-turfhorst-4-a/43980716/', 'Turfhorst 4-A', 'Turfhorst 4-A', '8091 EH', 'WEZEP', None, ' 2.700 /maand', 2700.0, 'month', None, None, 'house', 'rental', 220, None, None, 5, None, None, None, None, None, None, None, 'A++', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 55, 644973, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/561/627.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:38:55,690 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 17:38:55,691 - database.telegram_db - INFO - Property data for id 1621: (1621, 'funda', '43980657', '634138d3018a2f857d08c8b7ce4f90df', 'https://www.funda.nl/detail/huur/den-haag/appartement-parelmoerhorst-14/43980657/', 'Parelmoerhorst 14', 'Parelmoerhorst 14', '2592 SE', 'DEN HAAG', None, ' 1.995 /maand', 1995.0, 'month', None, None, 'apartment', 'rental', 91, None, None, 2, None, None, None, None, None, None, None, 'B', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 55, 690501, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/558/773.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:38:55,691 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1621: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...', params: (1621, 'funda', '43980657', '634138d3018a2f857d08c8b7ce4f90df', 'https://www.funda.nl/detail/huur/den-haag/appartement-parelmoerhorst-14/43980657/', 'Parelmoerhorst 14', 'Parelmoerhorst 14', '2592 SE', 'DEN HAAG', None, ' 1.995 /maand', 1995.0, 'month', None, None, 'apartment', 'rental', 91, None, None, 2, None, None, None, None, None, None, None, 'B', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 55, 690501, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/558/773.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:38:55,692 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 17:38:55,693 - database.telegram_db - INFO - Property data for id 1622: (1622, 'funda', '43988117', 'fc313c657088cd2d69963e230e15169b', 'https://www.funda.nl/detail/huur/amsterdam/appartement-gelrestraat-51/43988117/', 'Gelrestraat 51', 'Gelrestraat 51', '1079 MZ', 'AMSTERDAM', None, ' 2.325 /maand', 2325.0, 'month', None, None, 'apartment', 'rental', 65, None, None, 2, None, None, None, None, None, None, None, 'A', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 55, 692260, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/490/023.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:38:55,693 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1622: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...', params: (1622, 'funda', '43988117', 'fc313c657088cd2d69963e230e15169b', 'https://www.funda.nl/detail/huur/amsterdam/appartement-gelrestraat-51/43988117/', 'Gelrestraat 51', 'Gelrestraat 51', '1079 MZ', 'AMSTERDAM', None, ' 2.325 /maand', 2325.0, 'month', None, None, 'apartment', 'rental', 65, None, None, 2, None, None, None, None, None, None, None, 'A', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 55, 692260, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/490/023.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:38:55,693 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 17:38:55,695 - database.telegram_db - INFO - Property data for id 1623: (1623, 'funda', '43988107', '8e6c44d5f97b2eaf80c2e3c2a7598211', 'https://www.funda.nl/detail/huur/amsterdam/appartement-carnapstraat-70/43988107/', 'Carnapstraat 70', 'Carnapstraat 70', '1062 KT', 'AMSTERDAM', None, ' 2.425 /maand', 2425.0, 'month', None, None, 'apartment', 'rental', 92, None, None, 2, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 55, 693948, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/489/636.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:38:55,695 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1623: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...', params: (1623, 'funda', '43988107', '8e6c44d5f97b2eaf80c2e3c2a7598211', 'https://www.funda.nl/detail/huur/amsterdam/appartement-carnapstraat-70/43988107/', 'Carnapstraat 70', 'Carnapstraat 70', '1062 KT', 'AMSTERDAM', None, ' 2.425 /maand', 2425.0, 'month', None, None, 'apartment', 'rental', 92, None, None, 2, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 55, 693948, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/489/636.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:38:55,695 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 17:38:55,697 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 0.97s
2025-04-20 17:38:55,697 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:38:56,732 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 17:38:56,735 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 1.04s
2025-04-20 17:38:56,735 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 17:38:56,735 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:38:56,735 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:38:56,735 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:38:56,735 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:38:56,735 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:38:56,735 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:38:56,735 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:38:56,735 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:38:56,735 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:38:57,657 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:38:57,659 - database.telegram_db - INFO - Property data for id 1624: (1624, 'pararius', 'decbf94e', '5737486fec4ea7433fec7cfe6e07420f', 'https://www.pararius.com/room-for-rent/tilburg/decbf94e/veestraat', 'Room Veestraat', 'Veestraat', '5021 PT', 'TILBURG', 'Zeeheldenbuurt', '470 per month', 470.0, 'month', None, None, 'room', 'rental', 18, None, None, 1, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 57, 657841, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/decbf94e-5876-5ed2-9a9f-309dd19409da/8c101a34fd19313ef54a9ad798b2a8c1.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:38:57,659 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1624: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...', params: (1624, 'pararius', 'decbf94e', '5737486fec4ea7433fec7cfe6e07420f', 'https://www.pararius.com/room-for-rent/tilburg/decbf94e/veestraat', 'Room Veestraat', 'Veestraat', '5021 PT', 'TILBURG', 'Zeeheldenbuurt', '470 per month', 470.0, 'month', None, None, 'room', 'rental', 18, None, None, 1, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 57, 657841, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/decbf94e-5876-5ed2-9a9f-309dd19409da/8c101a34fd19313ef54a9ad798b2a8c1.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:38:57,659 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 17:38:57,661 - database.telegram_db - INFO - Property data for id 1625: (1625, 'pararius', '35565540', '4099dd69b612fce3ebee378168ed624c', 'https://www.pararius.com/apartment-for-rent/bergen-op-zoom/35565540/steenbergsestraat', 'Flat Steenbergsestraat', 'Steenbergsestraat', '4611 TC', 'BERGEN OP ZOOM', 'Centrum', '950 per month', 950.0, 'month', None, None, 'apartment', 'rental', 50, None, None, 2, 1, None, None, None, None, None, None, None, 'upholstered', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 57, 660286, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/35565540-ba22-5d40-a665-dbd095ea79fd/a49c5639a3af92848967ed61d2800098.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:38:57,661 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1625: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...', params: (1625, 'pararius', '35565540', '4099dd69b612fce3ebee378168ed624c', 'https://www.pararius.com/apartment-for-rent/bergen-op-zoom/35565540/steenbergsestraat', 'Flat Steenbergsestraat', 'Steenbergsestraat', '4611 TC', 'BERGEN OP ZOOM', 'Centrum', '950 per month', 950.0, 'month', None, None, 'apartment', 'rental', 50, None, None, 2, 1, None, None, None, None, None, None, None, 'upholstered', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 57, 660286, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/35565540-ba22-5d40-a665-dbd095ea79fd/a49c5639a3af92848967ed61d2800098.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:38:57,661 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 17:38:57,663 - database.telegram_db - INFO - Property data for id 1626: (1626, 'pararius', '0dee4b1a', 'b4c130e9de42bd785307b926ebff8117', 'https://www.pararius.com/apartment-for-rent/amsterdam/0dee4b1a/hoofdweg', 'Flat Hoofdweg 604', 'Hoofdweg 604', '1055 AB', 'AMSTERDAM', 'Erasmuspark', '2,500 per month', 2500.0, 'month', None, None, 'apartment', 'rental', 93, None, None, 3, 2, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 57, 662242, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/0dee4b1a-a781-57d4-9dad-2021b795737c/4cf40a0e10d856bf63ef4b1528a764b4.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:38:57,663 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1626: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...', params: (1626, 'pararius', '0dee4b1a', 'b4c130e9de42bd785307b926ebff8117', 'https://www.pararius.com/apartment-for-rent/amsterdam/0dee4b1a/hoofdweg', 'Flat Hoofdweg 604', 'Hoofdweg 604', '1055 AB', 'AMSTERDAM', 'Erasmuspark', '2,500 per month', 2500.0, 'month', None, None, 'apartment', 'rental', 93, None, None, 3, 2, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 57, 662242, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/0dee4b1a-a781-57d4-9dad-2021b795737c/4cf40a0e10d856bf63ef4b1528a764b4.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:38:57,663 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 17:38:57,665 - database.telegram_db - INFO - Property data for id 1627: (1627, 'pararius', '1e58e653', '179e9065c0eff96ed8492c80c3f2fdd4', 'https://www.pararius.com/apartment-for-rent/maastricht/1e58e653/endepolsdomein', 'Flat Endepolsdomein', 'Endepolsdomein', '6229 EM', 'MAASTRICHT', 'Randwyck', '896 per month', 896.0, 'month', None, None, 'apartment', 'rental', 25, None, None, 1, None, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 57, 664097, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/1e58e653-438c-54e7-aabf-c009fed469a4/4bdc3bb92e19aa053fd4d01b5a801c0b.webp?width=600&auto=webp'], {}, None)
2025-04-20 17:38:57,665 - database.telegram_db - ERROR - Error adding matched properties to queue for property_id 1627: invalid input syntax for type integer: "rental"
CONTEXT:  unnamed portal parameter $8 = '...', params: (1627, 'pararius', '1e58e653', '179e9065c0eff96ed8492c80c3f2fdd4', 'https://www.pararius.com/apartment-for-rent/maastricht/1e58e653/endepolsdomein', 'Flat Endepolsdomein', 'Endepolsdomein', '6229 EM', 'MAASTRICHT', 'Randwyck', '896 per month', 896.0, 'month', None, None, 'apartment', 'rental', 25, None, None, 1, None, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 38, 57, 664097, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/1e58e653-438c-54e7-aabf-c009fed469a4/4bdc3bb92e19aa053fd4d01b5a801c0b.webp?width=600&auto=webp'], {}, None)
2025-04-20 17:38:57,665 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 17:38:57,666 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.93s
2025-04-20 17:38:57,666 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 17:38:58,487 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:38:58,493 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 0.83s
2025-04-20 17:38:58,493 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:38:58,493 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:38:58,493 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:38:58,493 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:38:58,493 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:38:58,493 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:38:58,493 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:38:58,493 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:38:58,493 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:38:58,493 - main - INFO - City-based scanning skipped
2025-04-20 17:38:58,493 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 17:38:58,493 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:38:58,498 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:38:58,498 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:40:26,966 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:40:40,421 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:40:40.421199
2025-04-20 17:40:40,449 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:40:40,449 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:40:40,450 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:40:40,460 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:40:40,474 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:40:40,474 - main - INFO - Starting new scan cycle...
2025-04-20 17:40:40,477 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:40:40,477 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:40:41,609 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:40:41,610 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:40:41,659 - database.telegram_db - INFO - Property data for id 1628: (1628, 'funda', '43980716', 'b607b260a805e2367d45e808389b5156', 'https://www.funda.nl/detail/huur/wezep/huis-turfhorst-4-a/43980716/', 'Turfhorst 4-A', 'Turfhorst 4-A', '8091 EH', 'WEZEP', None, ' 2.700 /maand', 2700.0, 'month', None, None, 'house', 'rental', 220, None, None, 5, None, None, None, None, None, None, None, 'A++', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 40, 41, 613224, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/561/627.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:40:41,661 - database.telegram_db - INFO - Queued property_id 1628 for 0 users
2025-04-20 17:40:41,661 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 17:40:41,662 - database.telegram_db - INFO - Property data for id 1629: (1629, 'funda', '43980657', '634138d3018a2f857d08c8b7ce4f90df', 'https://www.funda.nl/detail/huur/den-haag/appartement-parelmoerhorst-14/43980657/', 'Parelmoerhorst 14', 'Parelmoerhorst 14', '2592 SE', 'DEN HAAG', None, ' 1.995 /maand', 1995.0, 'month', None, None, 'apartment', 'rental', 91, None, None, 2, None, None, None, None, None, None, None, 'B', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 40, 41, 661911, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/558/773.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:40:41,663 - database.telegram_db - INFO - Queued property_id 1629 for 0 users
2025-04-20 17:40:41,663 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 17:40:41,664 - database.telegram_db - INFO - Property data for id 1630: (1630, 'funda', '43988117', 'fc313c657088cd2d69963e230e15169b', 'https://www.funda.nl/detail/huur/amsterdam/appartement-gelrestraat-51/43988117/', 'Gelrestraat 51', 'Gelrestraat 51', '1079 MZ', 'AMSTERDAM', None, ' 2.325 /maand', 2325.0, 'month', None, None, 'apartment', 'rental', 65, None, None, 2, None, None, None, None, None, None, None, 'A', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 40, 41, 663672, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/490/023.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:40:41,666 - database.telegram_db - INFO - Queued property_id 1630 for 1 users
2025-04-20 17:40:41,666 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 1 users
2025-04-20 17:40:41,668 - database.telegram_db - INFO - Property data for id 1631: (1631, 'funda', '43988107', '8e6c44d5f97b2eaf80c2e3c2a7598211', 'https://www.funda.nl/detail/huur/amsterdam/appartement-carnapstraat-70/43988107/', 'Carnapstraat 70', 'Carnapstraat 70', '1062 KT', 'AMSTERDAM', None, ' 2.425 /maand', 2425.0, 'month', None, None, 'apartment', 'rental', 92, None, None, 2, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 40, 41, 667065, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/489/636.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:40:41,669 - database.telegram_db - INFO - Queued property_id 1631 for 1 users
2025-04-20 17:40:41,669 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 1 users
2025-04-20 17:40:41,670 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.19s
2025-04-20 17:40:41,670 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:40:42,411 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 17:40:42,412 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:40:42,412 - utils.http - INFO - Anti-bot retry 1/3 using Mobile Chrome Android profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down", waiting 3.8 seconds...
2025-04-20 17:40:47,659 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:40:47,661 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 17:40:47,663 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 5.99s
2025-04-20 17:40:47,663 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 17:40:47,663 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:40:47,663 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:40:47,663 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:40:47,663 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:40:47,664 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:40:47,664 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:40:47,664 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:40:47,664 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:40:47,664 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:40:48,273 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:40:48,277 - database.telegram_db - INFO - Property data for id 1632: (1632, 'pararius', 'decbf94e', '5737486fec4ea7433fec7cfe6e07420f', 'https://www.pararius.com/room-for-rent/tilburg/decbf94e/veestraat', 'Room Veestraat', 'Veestraat', '5021 PT', 'TILBURG', 'Zeeheldenbuurt', '470 per month', 470.0, 'month', None, None, 'room', 'rental', 18, None, None, 1, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 40, 48, 274880, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/decbf94e-5876-5ed2-9a9f-309dd19409da/8c101a34fd19313ef54a9ad798b2a8c1.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:40:48,279 - database.telegram_db - INFO - Queued property_id 1632 for 0 users
2025-04-20 17:40:48,279 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 17:40:48,283 - database.telegram_db - INFO - Property data for id 1633: (1633, 'pararius', '35565540', '4099dd69b612fce3ebee378168ed624c', 'https://www.pararius.com/apartment-for-rent/bergen-op-zoom/35565540/steenbergsestraat', 'Flat Steenbergsestraat', 'Steenbergsestraat', '4611 TC', 'BERGEN OP ZOOM', 'Centrum', '950 per month', 950.0, 'month', None, None, 'apartment', 'rental', 50, None, None, 2, 1, None, None, None, None, None, None, None, 'upholstered', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 40, 48, 280681, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/35565540-ba22-5d40-a665-dbd095ea79fd/a49c5639a3af92848967ed61d2800098.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:40:48,284 - database.telegram_db - INFO - Queued property_id 1633 for 0 users
2025-04-20 17:40:48,284 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 17:40:48,286 - database.telegram_db - INFO - Property data for id 1634: (1634, 'pararius', '0dee4b1a', 'b4c130e9de42bd785307b926ebff8117', 'https://www.pararius.com/apartment-for-rent/amsterdam/0dee4b1a/hoofdweg', 'Flat Hoofdweg 604', 'Hoofdweg 604', '1055 AB', 'AMSTERDAM', 'Erasmuspark', '2,500 per month', 2500.0, 'month', None, None, 'apartment', 'rental', 93, None, None, 3, 2, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 40, 48, 285264, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/0dee4b1a-a781-57d4-9dad-2021b795737c/4cf40a0e10d856bf63ef4b1528a764b4.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:40:48,288 - database.telegram_db - INFO - Queued property_id 1634 for 1 users
2025-04-20 17:40:48,288 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 1 users
2025-04-20 17:40:48,291 - database.telegram_db - INFO - Property data for id 1635: (1635, 'pararius', '1e58e653', '179e9065c0eff96ed8492c80c3f2fdd4', 'https://www.pararius.com/apartment-for-rent/maastricht/1e58e653/endepolsdomein', 'Flat Endepolsdomein', 'Endepolsdomein', '6229 EM', 'MAASTRICHT', 'Randwyck', '896 per month', 896.0, 'month', None, None, 'apartment', 'rental', 25, None, None, 1, None, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 40, 48, 288875, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/1e58e653-438c-54e7-aabf-c009fed469a4/4bdc3bb92e19aa053fd4d01b5a801c0b.webp?width=600&auto=webp'], {}, None)
2025-04-20 17:40:48,292 - database.telegram_db - INFO - Queued property_id 1635 for 0 users
2025-04-20 17:40:48,292 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 17:40:48,293 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.63s
2025-04-20 17:40:48,293 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 17:40:49,385 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:40:49,390 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.10s
2025-04-20 17:40:49,390 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:40:49,390 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:40:49,390 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:40:49,391 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:40:49,391 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:40:49,391 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:40:49,391 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:40:49,391 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:40:49,391 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:40:49,391 - main - INFO - City-based scanning skipped
2025-04-20 17:40:49,391 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 17:40:49,391 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:40:49,400 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:40:49,400 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:45:49,403 - main - INFO - Starting new scan cycle...
2025-04-20 17:45:49,409 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:45:49,409 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:45:50,380 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:45:50,381 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:45:50,394 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 0.98s
2025-04-20 17:45:50,394 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:45:50,394 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:45:50,394 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:45:50,394 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:45:50,394 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:45:50,394 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:45:50,394 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:45:50,394 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:45:50,395 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:45:50,395 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:45:50,395 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:45:51,616 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:45:51,626 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.23s
2025-04-20 17:45:51,627 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:45:51,627 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:45:51,627 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:45:51,627 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:45:51,627 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:45:51,627 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:45:51,627 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:45:51,627 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:45:51,627 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:45:51,627 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:45:51,627 - main - INFO - City-based scanning skipped
2025-04-20 17:45:51,627 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:45:51,627 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:45:51,629 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:45:51,629 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:50:51,636 - main - INFO - Starting new scan cycle...
2025-04-20 17:50:51,643 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:50:51,644 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:50:52,869 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:50:52,870 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:50:52,882 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.24s
2025-04-20 17:50:52,882 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:50:52,883 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:50:52,883 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:50:52,883 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:50:52,883 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:50:52,883 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:50:52,883 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:50:52,883 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:50:52,883 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:50:52,883 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:50:52,883 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:50:53,908 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:50:53,918 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.03s
2025-04-20 17:50:53,918 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:50:53,918 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:50:53,918 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:50:53,918 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:50:53,918 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:50:53,918 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:50:53,918 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:50:53,918 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:50:53,918 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:50:53,918 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:50:53,918 - main - INFO - City-based scanning skipped
2025-04-20 17:50:53,918 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:50:53,918 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:50:53,921 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:50:53,921 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:51:39,427 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 17:53:21,169 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 17:53:21.169781
2025-04-20 17:53:21,191 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 17:53:21,191 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 17:53:21,192 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:53:21,198 - database.migrations - INFO - Database initialized successfully
2025-04-20 17:53:21,204 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 17:53:21,204 - main - INFO - Starting new scan cycle...
2025-04-20 17:53:21,206 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:53:21,207 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:53:21,991 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:53:21,992 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:53:22,054 - database.telegram_db - INFO - Property data for id 1636: (1636, 'funda', '43980716', 'b607b260a805e2367d45e808389b5156', 'https://www.funda.nl/detail/huur/wezep/huis-turfhorst-4-a/43980716/', 'Turfhorst 4-A', 'Turfhorst 4-A', '8091 EH', 'WEZEP', None, ' 2.700 /maand', 2700.0, 'month', None, None, 'house', 'rental', 220, None, None, 5, None, None, None, None, None, None, None, 'A++', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 53, 21, 996906, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/561/627.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:53:22,056 - database.telegram_db - INFO - Queued property_id 1636 for 0 users
2025-04-20 17:53:22,056 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 17:53:22,058 - database.telegram_db - INFO - Property data for id 1637: (1637, 'funda', '43980657', '634138d3018a2f857d08c8b7ce4f90df', 'https://www.funda.nl/detail/huur/den-haag/appartement-parelmoerhorst-14/43980657/', 'Parelmoerhorst 14', 'Parelmoerhorst 14', '2592 SE', 'DEN HAAG', None, ' 1.995 /maand', 1995.0, 'month', None, None, 'apartment', 'rental', 91, None, None, 2, None, None, None, None, None, None, None, 'B', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 53, 22, 57295, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/558/773.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:53:22,058 - database.telegram_db - INFO - Queued property_id 1637 for 0 users
2025-04-20 17:53:22,058 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 17:53:22,060 - database.telegram_db - INFO - Property data for id 1638: (1638, 'funda', '43988117', 'fc313c657088cd2d69963e230e15169b', 'https://www.funda.nl/detail/huur/amsterdam/appartement-gelrestraat-51/43988117/', 'Gelrestraat 51', 'Gelrestraat 51', '1079 MZ', 'AMSTERDAM', None, ' 2.325 /maand', 2325.0, 'month', None, None, 'apartment', 'rental', 65, None, None, 2, None, None, None, None, None, None, None, 'A', None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 53, 22, 59199, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/490/023.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:53:22,061 - database.telegram_db - INFO - Queued property_id 1638 for 1 users
2025-04-20 17:53:22,061 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 1 users
2025-04-20 17:53:22,062 - database.telegram_db - INFO - Property data for id 1639: (1639, 'funda', '43988107', '8e6c44d5f97b2eaf80c2e3c2a7598211', 'https://www.funda.nl/detail/huur/amsterdam/appartement-carnapstraat-70/43988107/', 'Carnapstraat 70', 'Carnapstraat 70', '1062 KT', 'AMSTERDAM', None, ' 2.425 /maand', 2425.0, 'month', None, None, 'apartment', 'rental', 92, None, None, 2, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 53, 22, 61516, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/489/636.jpg?options=width=716,height=478'], {}, None)
2025-04-20 17:53:22,063 - database.telegram_db - INFO - Queued property_id 1639 for 1 users
2025-04-20 17:53:22,063 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 1 users
2025-04-20 17:53:22,064 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 0.86s
2025-04-20 17:53:22,064 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 17:53:23,090 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 17:53:23,092 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 1.03s
2025-04-20 17:53:23,092 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 17:53:23,092 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:53:23,092 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:53:23,092 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:53:23,092 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:53:23,092 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:53:23,092 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:53:23,092 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:53:23,092 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:53:23,092 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:53:23,738 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:53:23,740 - database.telegram_db - INFO - Property data for id 1640: (1640, 'pararius', 'decbf94e', '5737486fec4ea7433fec7cfe6e07420f', 'https://www.pararius.com/room-for-rent/tilburg/decbf94e/veestraat', 'Room Veestraat', 'Veestraat', '5021 PT', 'TILBURG', 'Zeeheldenbuurt', '470 per month', 470.0, 'month', None, None, 'room', 'rental', 18, None, None, 1, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 17, 53, 23, 738858, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/decbf94e-5876-5ed2-9a9f-309dd19409da/8c101a34fd19313ef54a9ad798b2a8c1.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:53:23,741 - database.telegram_db - INFO - Queued property_id 1640 for 0 users
2025-04-20 17:53:23,741 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 17:53:23,742 - database.telegram_db - INFO - Property data for id 1641: (1641, 'pararius', '35565540', '4099dd69b612fce3ebee378168ed624c', 'https://www.pararius.com/apartment-for-rent/bergen-op-zoom/35565540/steenbergsestraat', 'Flat Steenbergsestraat', 'Steenbergsestraat', '4611 TC', 'BERGEN OP ZOOM', 'Centrum', '950 per month', 950.0, 'month', None, None, 'apartment', 'rental', 50, None, None, 2, 1, None, None, None, None, None, None, None, 'upholstered', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 53, 23, 741596, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/35565540-ba22-5d40-a665-dbd095ea79fd/a49c5639a3af92848967ed61d2800098.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:53:23,743 - database.telegram_db - INFO - Queued property_id 1641 for 0 users
2025-04-20 17:53:23,743 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 17:53:23,745 - database.telegram_db - INFO - Property data for id 1642: (1642, 'pararius', '0dee4b1a', 'b4c130e9de42bd785307b926ebff8117', 'https://www.pararius.com/apartment-for-rent/amsterdam/0dee4b1a/hoofdweg', 'Flat Hoofdweg 604', 'Hoofdweg 604', '1055 AB', 'AMSTERDAM', 'Erasmuspark', '2,500 per month', 2500.0, 'month', None, None, 'apartment', 'rental', 93, None, None, 3, 2, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 53, 23, 744172, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/0dee4b1a-a781-57d4-9dad-2021b795737c/4cf40a0e10d856bf63ef4b1528a764b4.jpg?width=600&auto=webp'], {}, None)
2025-04-20 17:53:23,745 - database.telegram_db - INFO - Queued property_id 1642 for 1 users
2025-04-20 17:53:23,746 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 1 users
2025-04-20 17:53:23,747 - database.telegram_db - INFO - Property data for id 1643: (1643, 'pararius', '1e58e653', '179e9065c0eff96ed8492c80c3f2fdd4', 'https://www.pararius.com/apartment-for-rent/maastricht/1e58e653/endepolsdomein', 'Flat Endepolsdomein', 'Endepolsdomein', '6229 EM', 'MAASTRICHT', 'Randwyck', '896 per month', 896.0, 'month', None, None, 'apartment', 'rental', 25, None, None, 1, None, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 17, 53, 23, 746240, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/1e58e653-438c-54e7-aabf-c009fed469a4/4bdc3bb92e19aa053fd4d01b5a801c0b.webp?width=600&auto=webp'], {}, None)
2025-04-20 17:53:23,747 - database.telegram_db - INFO - Queued property_id 1643 for 0 users
2025-04-20 17:53:23,748 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 17:53:23,748 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.66s
2025-04-20 17:53:23,749 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 17:53:24,983 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:53:24,988 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.24s
2025-04-20 17:53:24,989 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:53:24,989 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:53:24,989 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:53:24,989 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:53:24,989 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:53:24,989 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:53:24,989 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:53:24,989 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:53:24,989 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:53:24,989 - main - INFO - City-based scanning skipped
2025-04-20 17:53:24,989 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 17:53:24,989 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:53:24,997 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:53:24,997 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 17:58:25,004 - main - INFO - Starting new scan cycle...
2025-04-20 17:58:25,015 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 17:58:25,015 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 17:58:25,701 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 17:58:25,702 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 17:58:25,715 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 0.70s
2025-04-20 17:58:25,715 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:58:25,715 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 17:58:25,715 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 17:58:25,715 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 17:58:25,716 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 17:58:25,716 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 17:58:25,716 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 17:58:25,716 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 17:58:25,716 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 17:58:25,716 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 17:58:25,716 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 17:58:26,576 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 17:58:26,585 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.87s
2025-04-20 17:58:26,585 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 17:58:26,585 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 17:58:26,585 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 17:58:26,585 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 17:58:26,585 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 17:58:26,585 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 17:58:26,585 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 17:58:26,585 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 17:58:26,585 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 17:58:26,585 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 17:58:26,586 - main - INFO - City-based scanning skipped
2025-04-20 17:58:26,586 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 17:58:26,586 - main - INFO - Detecting potential duplicate listings...
2025-04-20 17:58:26,587 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 17:58:26,588 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:03:26,592 - main - INFO - Starting new scan cycle...
2025-04-20 18:03:26,599 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:03:26,599 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:03:27,475 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:03:27,476 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:03:27,484 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 0.88s
2025-04-20 18:03:27,484 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 18:03:27,484 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 18:03:27,484 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:03:27,484 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:03:27,484 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:03:27,484 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:03:27,484 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:03:27,484 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:03:27,484 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:03:27,484 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:03:27,484 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:03:28,235 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:03:28,242 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.76s
2025-04-20 18:03:28,242 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 18:03:28,242 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 18:03:28,242 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:03:28,242 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:03:28,242 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:03:28,242 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:03:28,242 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:03:28,242 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:03:28,242 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:03:28,242 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:03:28,242 - main - INFO - City-based scanning skipped
2025-04-20 18:03:28,242 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 18:03:28,242 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:03:28,244 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:03:28,244 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:08:28,251 - main - INFO - Starting new scan cycle...
2025-04-20 18:08:28,259 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:08:28,260 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:08:29,045 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:08:29,047 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:08:29,062 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 0.80s
2025-04-20 18:08:29,062 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 18:08:29,062 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 18:08:29,062 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:08:29,062 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:08:29,062 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:08:29,062 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:08:29,062 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:08:29,062 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:08:29,062 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:08:29,062 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:08:29,062 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:08:30,042 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:08:30,048 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.98s
2025-04-20 18:08:30,048 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 18:08:30,048 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 18:08:30,048 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:08:30,048 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:08:30,048 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:08:30,048 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:08:30,048 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:08:30,048 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:08:30,048 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:08:30,048 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:08:30,048 - main - INFO - City-based scanning skipped
2025-04-20 18:08:30,048 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 18:08:30,049 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:08:30,050 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:08:30,050 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:12:57,473 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:34:36,591 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:34:36.591352
2025-04-20 18:34:36,616 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:34:36,616 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:34:36,616 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:34:36,625 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:34:36,632 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 18:34:36,632 - main - INFO - Starting new scan cycle...
2025-04-20 18:34:36,634 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:34:36,634 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:34:37,698 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:34:37,699 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:34:37,741 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.11s
2025-04-20 18:34:37,741 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 18:34:37,741 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 18:34:37,741 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:34:37,742 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:34:37,742 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:34:37,742 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:34:37,742 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:34:37,742 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:34:37,742 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:34:37,742 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:34:37,742 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:34:38,467 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:34:38,479 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.73s
2025-04-20 18:34:38,479 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 18:34:38,479 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 18:34:38,479 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:34:38,479 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:34:38,479 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:34:38,479 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:34:38,479 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:34:38,479 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:34:38,479 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:34:38,479 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:34:38,479 - main - INFO - City-based scanning skipped
2025-04-20 18:34:38,479 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 18:34:38,479 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:34:38,493 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:34:38,493 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:35:54,872 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:36:36,382 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:36:36.382743
2025-04-20 18:36:36,408 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:36:36,408 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:36:36,409 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:36:36,416 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:36:36,423 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 18:36:36,423 - main - INFO - Starting new scan cycle...
2025-04-20 18:36:36,426 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:36:36,426 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:36:37,347 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:36:37,349 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:36:37,416 - database.telegram_db - INFO - Property data for id 1644: (1644, 'funda', '43980716', 'b607b260a805e2367d45e808389b5156', 'https://www.funda.nl/detail/huur/wezep/huis-turfhorst-4-a/43980716/', 'Turfhorst 4-A', 'Turfhorst 4-A', '8091 EH', 'WEZEP', None, ' 2.700 /maand', 2700.0, 'month', None, None, 'house', 'rental', 220, None, None, 5, None, None, None, None, None, None, None, 'A++', None, None, None, None, None, datetime.datetime(2025, 4, 20, 18, 36, 37, 355441, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/561/627.jpg?options=width=716,height=478'], {}, None)
2025-04-20 18:36:37,419 - database.telegram_db - INFO - Queued property_id 1644 for 0 users
2025-04-20 18:36:37,419 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:36:37,422 - database.telegram_db - INFO - Property data for id 1645: (1645, 'funda', '43980657', '634138d3018a2f857d08c8b7ce4f90df', 'https://www.funda.nl/detail/huur/den-haag/appartement-parelmoerhorst-14/43980657/', 'Parelmoerhorst 14', 'Parelmoerhorst 14', '2592 SE', 'DEN HAAG', None, ' 1.995 /maand', 1995.0, 'month', None, None, 'apartment', 'rental', 91, None, None, 2, None, None, None, None, None, None, None, 'B', None, None, None, None, None, datetime.datetime(2025, 4, 20, 18, 36, 37, 420248, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/558/773.jpg?options=width=716,height=478'], {}, None)
2025-04-20 18:36:37,423 - database.telegram_db - INFO - Queued property_id 1645 for 0 users
2025-04-20 18:36:37,423 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:36:37,426 - database.telegram_db - INFO - Property data for id 1646: (1646, 'funda', '43988117', 'fc313c657088cd2d69963e230e15169b', 'https://www.funda.nl/detail/huur/amsterdam/appartement-gelrestraat-51/43988117/', 'Gelrestraat 51', 'Gelrestraat 51', '1079 MZ', 'AMSTERDAM', None, ' 2.325 /maand', 2325.0, 'month', None, None, 'apartment', 'rental', 65, None, None, 2, None, None, None, None, None, None, None, 'A', None, None, None, None, None, datetime.datetime(2025, 4, 20, 18, 36, 37, 424085, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/490/023.jpg?options=width=716,height=478'], {}, None)
2025-04-20 18:36:37,428 - database.telegram_db - INFO - Queued property_id 1646 for 1 users
2025-04-20 18:36:37,428 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 1 users
2025-04-20 18:36:37,430 - database.telegram_db - INFO - Property data for id 1647: (1647, 'funda', '43988107', '8e6c44d5f97b2eaf80c2e3c2a7598211', 'https://www.funda.nl/detail/huur/amsterdam/appartement-carnapstraat-70/43988107/', 'Carnapstraat 70', 'Carnapstraat 70', '1062 KT', 'AMSTERDAM', None, ' 2.425 /maand', 2425.0, 'month', None, None, 'apartment', 'rental', 92, None, None, 2, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 18, 36, 37, 428531, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/489/636.jpg?options=width=716,height=478'], {}, None)
2025-04-20 18:36:37,430 - database.telegram_db - INFO - Queued property_id 1647 for 0 users
2025-04-20 18:36:37,431 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 18:36:37,432 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.00s
2025-04-20 18:36:37,432 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:36:38,213 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:36:38,218 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 0.78s
2025-04-20 18:36:38,218 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:36:38,218 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:36:38,218 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:36:38,218 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:36:38,218 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:36:38,218 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:36:38,218 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:36:38,218 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:36:38,218 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:36:38,218 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:36:39,248 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:36:39,254 - database.telegram_db - INFO - Property data for id 1648: (1648, 'pararius', 'decbf94e', '5737486fec4ea7433fec7cfe6e07420f', 'https://www.pararius.com/room-for-rent/tilburg/decbf94e/veestraat', 'Room Veestraat', 'Veestraat', '5021 PT', 'TILBURG', 'Zeeheldenbuurt', '470 per month', 470.0, 'month', None, None, 'room', 'rental', 18, None, None, 1, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 18, 36, 39, 250514, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/decbf94e-5876-5ed2-9a9f-309dd19409da/8c101a34fd19313ef54a9ad798b2a8c1.jpg?width=600&auto=webp'], {}, None)
2025-04-20 18:36:39,256 - database.telegram_db - INFO - Queued property_id 1648 for 0 users
2025-04-20 18:36:39,256 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:36:39,260 - database.telegram_db - INFO - Property data for id 1649: (1649, 'pararius', '35565540', '4099dd69b612fce3ebee378168ed624c', 'https://www.pararius.com/apartment-for-rent/bergen-op-zoom/35565540/steenbergsestraat', 'Flat Steenbergsestraat', 'Steenbergsestraat', '4611 TC', 'BERGEN OP ZOOM', 'Centrum', '950 per month', 950.0, 'month', None, None, 'apartment', 'rental', 50, None, None, 2, 1, None, None, None, None, None, None, None, 'upholstered', None, None, None, None, datetime.datetime(2025, 4, 20, 18, 36, 39, 257347, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/35565540-ba22-5d40-a665-dbd095ea79fd/a49c5639a3af92848967ed61d2800098.jpg?width=600&auto=webp'], {}, None)
2025-04-20 18:36:39,261 - database.telegram_db - INFO - Queued property_id 1649 for 0 users
2025-04-20 18:36:39,262 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:36:39,264 - database.telegram_db - INFO - Property data for id 1650: (1650, 'pararius', '0dee4b1a', 'b4c130e9de42bd785307b926ebff8117', 'https://www.pararius.com/apartment-for-rent/amsterdam/0dee4b1a/hoofdweg', 'Flat Hoofdweg 604', 'Hoofdweg 604', '1055 AB', 'AMSTERDAM', 'Erasmuspark', '2,500 per month', 2500.0, 'month', None, None, 'apartment', 'rental', 93, None, None, 3, 2, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 18, 36, 39, 262538, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/0dee4b1a-a781-57d4-9dad-2021b795737c/4cf40a0e10d856bf63ef4b1528a764b4.jpg?width=600&auto=webp'], {}, None)
2025-04-20 18:36:39,265 - database.telegram_db - INFO - Queued property_id 1650 for 0 users
2025-04-20 18:36:39,265 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 18:36:39,267 - database.telegram_db - INFO - Property data for id 1651: (1651, 'pararius', '1e58e653', '179e9065c0eff96ed8492c80c3f2fdd4', 'https://www.pararius.com/apartment-for-rent/maastricht/1e58e653/endepolsdomein', 'Flat Endepolsdomein', 'Endepolsdomein', '6229 EM', 'MAASTRICHT', 'Randwyck', '896 per month', 896.0, 'month', None, None, 'apartment', 'rental', 25, None, None, 1, None, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 18, 36, 39, 265388, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/1e58e653-438c-54e7-aabf-c009fed469a4/4bdc3bb92e19aa053fd4d01b5a801c0b.webp?width=600&auto=webp'], {}, None)
2025-04-20 18:36:39,268 - database.telegram_db - INFO - Queued property_id 1651 for 0 users
2025-04-20 18:36:39,268 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:36:39,270 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.05s
2025-04-20 18:36:39,270 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:36:40,267 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:36:40,276 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.01s
2025-04-20 18:36:40,277 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:36:40,277 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:36:40,277 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:36:40,277 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:36:40,277 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:36:40,277 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:36:40,277 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:36:40,277 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:36:40,277 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:36:40,277 - main - INFO - City-based scanning skipped
2025-04-20 18:36:40,277 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:36:40,277 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:36:40,287 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:36:40,287 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:40:26,290 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:40:27,969 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:40:27.969043
2025-04-20 18:40:27,988 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:40:27,988 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:40:27,989 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:40:27,996 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:40:28,004 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 18:40:28,004 - main - INFO - Starting new scan cycle...
2025-04-20 18:40:28,007 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:40:28,007 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:40:29,286 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:40:29,310 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:40:29,402 - database.telegram_db - INFO - Property data for id 1652: (1652, 'funda', '43980716', 'b607b260a805e2367d45e808389b5156', 'https://www.funda.nl/detail/huur/wezep/huis-turfhorst-4-a/43980716/', 'Turfhorst 4-A', 'Turfhorst 4-A', '8091 EH', 'WEZEP', None, ' 2.700 /maand', 2700.0, 'month', None, None, 'house', 'rental', 220, None, None, 5, None, None, None, None, None, None, None, 'A++', None, None, None, None, None, datetime.datetime(2025, 4, 20, 18, 40, 29, 316569, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/561/627.jpg?options=width=716,height=478'], {}, None)
2025-04-20 18:40:29,405 - database.telegram_db - INFO - Queued property_id 1652 for 0 users
2025-04-20 18:40:29,405 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:40:29,408 - database.telegram_db - INFO - Property data for id 1653: (1653, 'funda', '43980657', '634138d3018a2f857d08c8b7ce4f90df', 'https://www.funda.nl/detail/huur/den-haag/appartement-parelmoerhorst-14/43980657/', 'Parelmoerhorst 14', 'Parelmoerhorst 14', '2592 SE', 'DEN HAAG', None, ' 1.995 /maand', 1995.0, 'month', None, None, 'apartment', 'rental', 91, None, None, 2, None, None, None, None, None, None, None, 'B', None, None, None, None, None, datetime.datetime(2025, 4, 20, 18, 40, 29, 406402, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/558/773.jpg?options=width=716,height=478'], {}, None)
2025-04-20 18:40:29,409 - database.telegram_db - INFO - Queued property_id 1653 for 0 users
2025-04-20 18:40:29,409 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:40:29,412 - database.telegram_db - INFO - Property data for id 1654: (1654, 'funda', '43988117', 'fc313c657088cd2d69963e230e15169b', 'https://www.funda.nl/detail/huur/amsterdam/appartement-gelrestraat-51/43988117/', 'Gelrestraat 51', 'Gelrestraat 51', '1079 MZ', 'AMSTERDAM', None, ' 2.325 /maand', 2325.0, 'month', None, None, 'apartment', 'rental', 65, None, None, 2, None, None, None, None, None, None, None, 'A', None, None, None, None, None, datetime.datetime(2025, 4, 20, 18, 40, 29, 410051, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/490/023.jpg?options=width=716,height=478'], {}, None)
2025-04-20 18:40:29,412 - database.telegram_db - INFO - Queued property_id 1654 for 0 users
2025-04-20 18:40:29,413 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 18:40:29,415 - database.telegram_db - INFO - Property data for id 1655: (1655, 'funda', '43988107', '8e6c44d5f97b2eaf80c2e3c2a7598211', 'https://www.funda.nl/detail/huur/amsterdam/appartement-carnapstraat-70/43988107/', 'Carnapstraat 70', 'Carnapstraat 70', '1062 KT', 'AMSTERDAM', None, ' 2.425 /maand', 2425.0, 'month', None, None, 'apartment', 'rental', 92, None, None, 2, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 18, 40, 29, 413441, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://cloud.funda.nl/valentina_media/208/489/636.jpg?options=width=716,height=478'], {}, None)
2025-04-20 18:40:29,416 - database.telegram_db - INFO - Queued property_id 1655 for 0 users
2025-04-20 18:40:29,416 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 18:40:29,440 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.41s
2025-04-20 18:40:29,440 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:40:30,455 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:40:30,458 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 1.01s
2025-04-20 18:40:30,458 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:40:30,458 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:40:30,458 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:40:30,458 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:40:30,458 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:40:30,458 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:40:30,458 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:40:30,458 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:40:30,458 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:40:30,458 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:40:31,481 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:40:31,487 - database.telegram_db - INFO - Property data for id 1656: (1656, 'pararius', 'decbf94e', '5737486fec4ea7433fec7cfe6e07420f', 'https://www.pararius.com/room-for-rent/tilburg/decbf94e/veestraat', 'Room Veestraat', 'Veestraat', '5021 PT', 'TILBURG', 'Zeeheldenbuurt', '470 per month', 470.0, 'month', None, None, 'room', 'rental', 18, None, None, 1, None, None, None, None, None, None, None, None, None, None, None, None, None, datetime.datetime(2025, 4, 20, 18, 40, 31, 483099, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/decbf94e-5876-5ed2-9a9f-309dd19409da/8c101a34fd19313ef54a9ad798b2a8c1.jpg?width=600&auto=webp'], {}, None)
2025-04-20 18:40:31,488 - database.telegram_db - INFO - Queued property_id 1656 for 0 users
2025-04-20 18:40:31,489 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:40:31,492 - database.telegram_db - INFO - Property data for id 1657: (1657, 'pararius', '35565540', '4099dd69b612fce3ebee378168ed624c', 'https://www.pararius.com/apartment-for-rent/bergen-op-zoom/35565540/steenbergsestraat', 'Flat Steenbergsestraat', 'Steenbergsestraat', '4611 TC', 'BERGEN OP ZOOM', 'Centrum', '950 per month', 950.0, 'month', None, None, 'apartment', 'rental', 50, None, None, 2, 1, None, None, None, None, None, None, None, 'upholstered', None, None, None, None, datetime.datetime(2025, 4, 20, 18, 40, 31, 489728, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/35565540-ba22-5d40-a665-dbd095ea79fd/a49c5639a3af92848967ed61d2800098.jpg?width=600&auto=webp'], {}, None)
2025-04-20 18:40:31,494 - database.telegram_db - INFO - Queued property_id 1657 for 0 users
2025-04-20 18:40:31,494 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:40:31,497 - database.telegram_db - INFO - Property data for id 1658: (1658, 'pararius', '0dee4b1a', 'b4c130e9de42bd785307b926ebff8117', 'https://www.pararius.com/apartment-for-rent/amsterdam/0dee4b1a/hoofdweg', 'Flat Hoofdweg 604', 'Hoofdweg 604', '1055 AB', 'AMSTERDAM', 'Erasmuspark', '2,500 per month', 2500.0, 'month', None, None, 'apartment', 'rental', 93, None, None, 3, 2, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 18, 40, 31, 495354, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/0dee4b1a-a781-57d4-9dad-2021b795737c/4cf40a0e10d856bf63ef4b1528a764b4.jpg?width=600&auto=webp'], {}, None)
2025-04-20 18:40:31,499 - database.telegram_db - INFO - Queued property_id 1658 for 1 users
2025-04-20 18:40:31,499 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 1 users
2025-04-20 18:40:31,501 - database.telegram_db - INFO - Property data for id 1659: (1659, 'pararius', '1e58e653', '179e9065c0eff96ed8492c80c3f2fdd4', 'https://www.pararius.com/apartment-for-rent/maastricht/1e58e653/endepolsdomein', 'Flat Endepolsdomein', 'Endepolsdomein', '6229 EM', 'MAASTRICHT', 'Randwyck', '896 per month', 896.0, 'month', None, None, 'apartment', 'rental', 25, None, None, 1, None, None, None, None, None, None, None, None, 'furnished', None, None, None, None, datetime.datetime(2025, 4, 20, 18, 40, 31, 499625, tzinfo=zoneinfo.ZoneInfo(key='Europe/Amsterdam')), ['https://casco-media-prod.global.ssl.fastly.net/1e58e653-438c-54e7-aabf-c009fed469a4/4bdc3bb92e19aa053fd4d01b5a801c0b.webp?width=600&auto=webp'], {}, None)
2025-04-20 18:40:31,502 - database.telegram_db - INFO - Queued property_id 1659 for 0 users
2025-04-20 18:40:31,502 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:40:31,503 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.04s
2025-04-20 18:40:31,503 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:40:32,830 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:40:32,842 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.34s
2025-04-20 18:40:32,842 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:40:32,842 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:40:32,842 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:40:32,842 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:40:32,842 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:40:32,842 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:40:32,842 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:40:32,842 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:40:32,842 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:40:32,842 - main - INFO - City-based scanning skipped
2025-04-20 18:40:32,842 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:40:32,842 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:40:32,850 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:40:32,850 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:42:35,913 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:42:37,890 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:42:37.890881
2025-04-20 18:42:37,914 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:42:37,914 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:42:37,915 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:42:37,923 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:42:37,930 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 18:42:37,930 - main - INFO - Starting new scan cycle...
2025-04-20 18:42:37,933 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:42:37,933 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:42:39,151 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:42:39,153 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:42:39,308 - database.telegram_db - INFO - Queued property_id 1660 for 0 users
2025-04-20 18:42:39,308 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:42:39,312 - database.telegram_db - INFO - Queued property_id 1661 for 0 users
2025-04-20 18:42:39,312 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:42:39,316 - database.telegram_db - INFO - Queued property_id 1662 for 1 users
2025-04-20 18:42:39,316 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 1 users
2025-04-20 18:42:39,321 - database.telegram_db - INFO - Queued property_id 1663 for 1 users
2025-04-20 18:42:39,321 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 1 users
2025-04-20 18:42:39,323 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.39s
2025-04-20 18:42:39,323 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:42:40,310 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:42:40,313 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 0.99s
2025-04-20 18:42:40,313 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:42:40,313 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:42:40,313 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:42:40,313 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:42:40,313 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:42:40,313 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:42:40,313 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:42:40,313 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:42:40,313 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:42:40,313 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:42:40,936 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:42:40,943 - database.telegram_db - INFO - Queued property_id 1664 for 0 users
2025-04-20 18:42:40,943 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:42:40,948 - database.telegram_db - INFO - Queued property_id 1665 for 0 users
2025-04-20 18:42:40,948 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:42:40,952 - database.telegram_db - INFO - Queued property_id 1666 for 1 users
2025-04-20 18:42:40,952 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 1 users
2025-04-20 18:42:40,955 - database.telegram_db - INFO - Queued property_id 1667 for 0 users
2025-04-20 18:42:40,956 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:42:40,958 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.64s
2025-04-20 18:42:40,958 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:42:41,661 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:42:41,670 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 0.71s
2025-04-20 18:42:41,670 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:42:41,670 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:42:41,670 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:42:41,670 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:42:41,670 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:42:41,670 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:42:41,671 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:42:41,671 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:42:41,671 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:42:41,671 - main - INFO - City-based scanning skipped
2025-04-20 18:42:41,671 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:42:41,671 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:42:41,677 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:42:41,677 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:44:42,604 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:44:44,746 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:44:44.746963
2025-04-20 18:44:44,773 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:44:44,773 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:44:44,774 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:44:44,781 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:44:44,789 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 18:44:44,789 - main - INFO - Starting new scan cycle...
2025-04-20 18:44:44,792 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:44:44,792 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:44:45,883 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:44:45,884 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:44:46,085 - database.telegram_db - INFO - Queued property_id 1668 for 0 users
2025-04-20 18:44:46,086 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:44:46,090 - database.telegram_db - INFO - Queued property_id 1669 for 0 users
2025-04-20 18:44:46,090 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:44:46,120 - database.telegram_db - INFO - Queued property_id 1670 for 0 users
2025-04-20 18:44:46,120 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 18:44:46,127 - database.telegram_db - INFO - Queued property_id 1671 for 1 users
2025-04-20 18:44:46,128 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 1 users
2025-04-20 18:44:46,152 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.34s
2025-04-20 18:44:46,152 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:44:46,897 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:44:46,900 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 0.74s
2025-04-20 18:44:46,900 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:44:46,900 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:44:46,900 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:44:46,900 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:44:46,900 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:44:46,900 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:44:46,900 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:44:46,900 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:44:46,900 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:44:46,900 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:44:48,235 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:44:48,243 - database.telegram_db - INFO - Queued property_id 1672 for 0 users
2025-04-20 18:44:48,243 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:44:48,249 - database.telegram_db - INFO - Queued property_id 1673 for 0 users
2025-04-20 18:44:48,249 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:44:48,253 - database.telegram_db - INFO - Queued property_id 1674 for 1 users
2025-04-20 18:44:48,253 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 1 users
2025-04-20 18:44:48,256 - database.telegram_db - INFO - Queued property_id 1675 for 0 users
2025-04-20 18:44:48,257 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:44:48,258 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.36s
2025-04-20 18:44:48,258 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:44:49,302 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:44:49,314 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.05s
2025-04-20 18:44:49,314 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:44:49,314 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:44:49,314 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:44:49,314 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:44:49,314 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:44:49,315 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:44:49,315 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:44:49,315 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:44:49,315 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:44:49,315 - main - INFO - City-based scanning skipped
2025-04-20 18:44:49,315 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:44:49,315 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:44:49,323 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:44:49,323 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:46:09,978 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:46:20,103 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:46:20.103241
2025-04-20 18:46:20,126 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:46:20,126 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:46:20,127 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:46:20,136 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:46:20,144 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 18:46:20,145 - main - INFO - Starting new scan cycle...
2025-04-20 18:46:20,147 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:46:20,147 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:46:21,412 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:46:21,413 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:46:21,461 - database.telegram_db - INFO - Queued property_id 1676 for 0 users
2025-04-20 18:46:21,461 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:46:21,463 - database.telegram_db - INFO - Queued property_id 1677 for 0 users
2025-04-20 18:46:21,463 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:46:21,465 - database.telegram_db - INFO - Queued property_id 1678 for 0 users
2025-04-20 18:46:21,465 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 18:46:21,467 - database.telegram_db - INFO - Queued property_id 1679 for 1 users
2025-04-20 18:46:21,467 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 1 users
2025-04-20 18:46:21,468 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.32s
2025-04-20 18:46:21,468 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:46:22,740 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:46:22,743 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 1.27s
2025-04-20 18:46:22,743 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:46:22,743 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:46:22,743 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:46:22,743 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:46:22,743 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:46:22,743 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:46:22,744 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:46:22,744 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:46:22,744 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:46:22,744 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:46:23,482 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:46:23,485 - database.telegram_db - INFO - Queued property_id 1680 for 0 users
2025-04-20 18:46:23,485 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:46:23,489 - database.telegram_db - INFO - Queued property_id 1681 for 0 users
2025-04-20 18:46:23,489 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:46:23,491 - database.telegram_db - INFO - Queued property_id 1682 for 1 users
2025-04-20 18:46:23,491 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 1 users
2025-04-20 18:46:23,495 - database.telegram_db - INFO - Queued property_id 1683 for 0 users
2025-04-20 18:46:23,495 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:46:23,496 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.75s
2025-04-20 18:46:23,496 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:46:24,189 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:46:24,194 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 0.70s
2025-04-20 18:46:24,194 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:46:24,194 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:46:24,194 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:46:24,194 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:46:24,195 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:46:24,195 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:46:24,195 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:46:24,195 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:46:24,195 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:46:24,195 - main - INFO - City-based scanning skipped
2025-04-20 18:46:24,195 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:46:24,195 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:46:24,202 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:46:24,202 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:46:25,758 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:46:58,496 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:46:58.496372
2025-04-20 18:46:58,526 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:46:58,526 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:46:58,527 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:46:58,533 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:46:58,540 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 18:46:58,540 - main - INFO - Starting new scan cycle...
2025-04-20 18:46:58,543 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:46:58,543 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:46:59,976 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:46:59,977 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:47:00,057 - database.telegram_db - INFO - Queued property_id 1684 for 0 users
2025-04-20 18:47:00,057 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:47:00,060 - database.telegram_db - INFO - Queued property_id 1685 for 0 users
2025-04-20 18:47:00,060 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:47:00,063 - database.telegram_db - INFO - Queued property_id 1686 for 0 users
2025-04-20 18:47:00,063 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 18:47:00,066 - database.telegram_db - INFO - Queued property_id 1687 for 0 users
2025-04-20 18:47:00,066 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 18:47:00,068 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.52s
2025-04-20 18:47:00,068 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:47:00,682 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:47:00,686 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 0.61s
2025-04-20 18:47:00,686 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:47:00,686 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:47:00,686 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:47:00,686 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:47:00,687 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:47:00,687 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:47:00,687 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:47:00,687 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:47:00,687 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:47:00,687 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:47:01,321 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:47:01,326 - database.telegram_db - INFO - Queued property_id 1688 for 0 users
2025-04-20 18:47:01,326 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:47:01,330 - database.telegram_db - INFO - Queued property_id 1689 for 0 users
2025-04-20 18:47:01,330 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:47:01,332 - database.telegram_db - INFO - Queued property_id 1690 for 0 users
2025-04-20 18:47:01,333 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 18:47:01,335 - database.telegram_db - INFO - Queued property_id 1691 for 0 users
2025-04-20 18:47:01,335 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:47:01,336 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.65s
2025-04-20 18:47:01,336 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:47:02,265 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:47:02,277 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 0.94s
2025-04-20 18:47:02,277 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:47:02,277 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:47:02,277 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:47:02,277 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:47:02,277 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:47:02,277 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:47:02,277 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:47:02,277 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:47:02,277 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:47:02,277 - main - INFO - City-based scanning skipped
2025-04-20 18:47:02,277 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:47:02,277 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:47:02,294 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:47:02,294 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:47:03,482 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:49:16,757 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:49:16.757359
2025-04-20 18:49:16,786 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:49:16,786 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:49:16,786 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:49:16,793 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:49:16,801 - __main__ - INFO - Running continuous scanning with 300s interval
2025-04-20 18:49:16,801 - main - INFO - Starting new scan cycle...
2025-04-20 18:49:16,804 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:49:16,804 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:49:17,764 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:49:17,766 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:49:17,816 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.01s
2025-04-20 18:49:17,816 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 18:49:17,816 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 18:49:17,816 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:49:17,816 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:49:17,816 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:49:17,816 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:49:17,816 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:49:17,816 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:49:17,816 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:49:17,816 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:49:17,816 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:49:18,953 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:49:18,964 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.15s
2025-04-20 18:49:18,965 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 18:49:18,965 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 18:49:18,965 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:49:18,965 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:49:18,965 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:49:18,965 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:49:18,965 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:49:18,965 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:49:18,965 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:49:18,965 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:49:18,965 - main - INFO - City-based scanning skipped
2025-04-20 18:49:18,965 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 18:49:18,965 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:49:18,979 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:49:18,979 - main - INFO - Waiting 300 seconds until next scan...
2025-04-20 18:51:51,709 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:52:06,366 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:52:06.366391
2025-04-20 18:52:06,412 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:52:06,412 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:52:06,414 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:52:06,485 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:52:06,492 - __main__ - INFO - Running continuous scanning with 500s interval
2025-04-20 18:52:06,492 - main - INFO - Starting new scan cycle...
2025-04-20 18:52:06,494 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:52:06,495 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:52:07,566 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:52:07,568 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:52:07,624 - database.telegram_db - INFO - Queued property_id 1692 for 0 users
2025-04-20 18:52:07,624 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:52:07,626 - database.telegram_db - INFO - Queued property_id 1693 for 0 users
2025-04-20 18:52:07,626 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:52:07,628 - database.telegram_db - INFO - Queued property_id 1694 for 0 users
2025-04-20 18:52:07,628 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 18:52:07,629 - database.telegram_db - INFO - Queued property_id 1695 for 1 users
2025-04-20 18:52:07,629 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 1 users
2025-04-20 18:52:07,630 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.13s
2025-04-20 18:52:07,631 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:52:08,522 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 18:52:08,523 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:52:08,523 - utils.http - INFO - Anti-bot retry 1/3 using Firefox Windows profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down", waiting 4.2 seconds...
2025-04-20 18:52:14,356 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:52:14,358 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:52:14,360 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 6.73s
2025-04-20 18:52:14,360 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:52:14,360 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:52:14,360 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:52:14,360 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:52:14,360 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:52:14,360 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:52:14,360 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:52:14,360 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:52:14,360 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:52:14,360 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:52:15,398 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:52:15,407 - database.telegram_db - INFO - Queued property_id 1696 for 0 users
2025-04-20 18:52:15,408 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:52:15,412 - database.telegram_db - INFO - Queued property_id 1697 for 0 users
2025-04-20 18:52:15,412 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:52:15,415 - database.telegram_db - INFO - Queued property_id 1698 for 1 users
2025-04-20 18:52:15,416 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 1 users
2025-04-20 18:52:15,418 - database.telegram_db - INFO - Queued property_id 1699 for 0 users
2025-04-20 18:52:15,418 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:52:15,420 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.06s
2025-04-20 18:52:15,420 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:52:16,058 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:52:16,069 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 0.65s
2025-04-20 18:52:16,069 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:52:16,069 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:52:16,069 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:52:16,069 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:52:16,069 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:52:16,069 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:52:16,070 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:52:16,070 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:52:16,070 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:52:16,070 - main - INFO - City-based scanning skipped
2025-04-20 18:52:16,070 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:52:16,070 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:52:16,087 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:52:16,087 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 18:56:10,892 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:56:10.892050
2025-04-20 18:56:10,916 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:56:10,917 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:56:10,917 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:56:10,923 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:56:10,929 - __main__ - INFO - Running continuous scanning with 500s interval
2025-04-20 18:56:10,929 - main - INFO - Starting new scan cycle...
2025-04-20 18:56:10,932 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:56:10,932 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:56:11,839 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:56:11,841 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:56:11,892 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 0.96s
2025-04-20 18:56:11,892 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 18:56:11,892 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 18:56:11,892 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:56:11,892 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:56:11,892 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:56:11,892 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:56:11,892 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:56:11,892 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:56:11,892 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:56:11,892 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:56:11,892 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:56:13,037 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:56:13,046 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.15s
2025-04-20 18:56:13,046 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 18:56:13,046 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 18:56:13,046 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:56:13,046 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:56:13,047 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:56:13,047 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:56:13,047 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:56:13,047 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:56:13,047 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:56:13,047 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:56:13,047 - main - INFO - City-based scanning skipped
2025-04-20 18:56:13,047 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 18:56:13,047 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:56:13,059 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:56:13,059 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 18:56:48,563 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:56:51,013 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:56:51.013118
2025-04-20 18:56:51,210 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:56:51,217 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:56:51,222 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:56:51,235 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:56:51,246 - __main__ - INFO - Running continuous scanning with 500s interval
2025-04-20 18:56:51,247 - main - INFO - Starting new scan cycle...
2025-04-20 18:56:51,250 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:56:51,250 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:56:52,499 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:56:52,500 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:56:52,646 - database.telegram_db - INFO - Queued property_id 1700 for 0 users
2025-04-20 18:56:52,658 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:56:52,666 - database.telegram_db - INFO - Queued property_id 1701 for 0 users
2025-04-20 18:56:52,666 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:56:52,672 - database.telegram_db - INFO - Queued property_id 1702 for 0 users
2025-04-20 18:56:52,673 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 18:56:52,677 - database.telegram_db - INFO - Queued property_id 1703 for 0 users
2025-04-20 18:56:52,677 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 18:56:52,679 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.43s
2025-04-20 18:56:52,679 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:56:53,751 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:56:53,755 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 1.07s
2025-04-20 18:56:53,756 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:56:53,756 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:56:53,756 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:56:53,757 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:56:53,759 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:56:53,762 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:56:53,764 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:56:53,764 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:56:53,764 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:56:53,764 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:56:54,432 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:56:54,439 - database.telegram_db - INFO - Queued property_id 1704 for 0 users
2025-04-20 18:56:54,439 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:56:54,445 - database.telegram_db - INFO - Queued property_id 1705 for 0 users
2025-04-20 18:56:54,445 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:56:54,448 - database.telegram_db - INFO - Queued property_id 1706 for 0 users
2025-04-20 18:56:54,448 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 18:56:54,452 - database.telegram_db - INFO - Queued property_id 1707 for 0 users
2025-04-20 18:56:54,452 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:56:54,453 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.69s
2025-04-20 18:56:54,453 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:56:55,699 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:56:55,708 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.25s
2025-04-20 18:56:55,708 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:56:55,708 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:56:55,708 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:56:55,708 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:56:55,708 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:56:55,708 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:56:55,708 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:56:55,709 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:56:55,709 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:56:55,709 - main - INFO - City-based scanning skipped
2025-04-20 18:56:55,709 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:56:55,709 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:56:55,714 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:56:55,714 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 18:56:56,917 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:57:11,388 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:57:11.388703
2025-04-20 18:57:11,411 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:57:11,411 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:57:11,412 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:57:11,419 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:57:11,428 - __main__ - INFO - Running continuous scanning with 500s interval
2025-04-20 18:57:11,428 - main - INFO - Starting new scan cycle...
2025-04-20 18:57:11,431 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:57:11,431 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:57:12,693 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:57:12,693 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:57:12,737 - database.telegram_db - INFO - Queued property_id 1708 for 0 users
2025-04-20 18:57:12,737 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:57:12,739 - database.telegram_db - INFO - Queued property_id 1709 for 0 users
2025-04-20 18:57:12,739 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:57:12,741 - database.telegram_db - INFO - Queued property_id 1710 for 0 users
2025-04-20 18:57:12,741 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 18:57:12,742 - database.telegram_db - INFO - Queued property_id 1711 for 0 users
2025-04-20 18:57:12,742 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 18:57:12,743 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.31s
2025-04-20 18:57:12,743 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:57:13,550 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:57:13,551 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 0.81s
2025-04-20 18:57:13,551 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:57:13,551 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:57:13,551 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:57:13,551 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:57:13,551 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:57:13,551 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:57:13,551 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:57:13,552 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:57:13,552 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:57:13,552 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:57:14,706 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:57:14,709 - database.telegram_db - INFO - Queued property_id 1712 for 0 users
2025-04-20 18:57:14,709 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:57:14,711 - database.telegram_db - INFO - Queued property_id 1713 for 0 users
2025-04-20 18:57:14,711 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:57:14,713 - database.telegram_db - INFO - Queued property_id 1714 for 0 users
2025-04-20 18:57:14,713 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 18:57:14,715 - database.telegram_db - INFO - Queued property_id 1715 for 0 users
2025-04-20 18:57:14,715 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:57:14,716 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.16s
2025-04-20 18:57:14,716 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:57:15,666 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:57:15,670 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 0.95s
2025-04-20 18:57:15,671 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:57:15,671 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:57:15,671 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:57:15,671 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:57:15,671 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:57:15,671 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:57:15,671 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:57:15,671 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:57:15,671 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:57:15,671 - main - INFO - City-based scanning skipped
2025-04-20 18:57:15,671 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:57:15,671 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:57:15,680 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:57:15,680 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 18:57:17,344 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:57:31,992 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:57:31.992379
2025-04-20 18:57:32,022 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:57:32,022 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:57:32,023 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:57:32,033 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:57:32,041 - __main__ - INFO - Running continuous scanning with 500s interval
2025-04-20 18:57:32,041 - main - INFO - Starting new scan cycle...
2025-04-20 18:57:32,044 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:57:32,044 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:57:32,982 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:57:32,983 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:57:33,037 - database.telegram_db - INFO - Queued property_id 1716 for 0 users
2025-04-20 18:57:33,037 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:57:33,039 - database.telegram_db - INFO - Queued property_id 1717 for 0 users
2025-04-20 18:57:33,039 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:57:33,040 - database.telegram_db - INFO - Queued property_id 1718 for 0 users
2025-04-20 18:57:33,040 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 18:57:33,042 - database.telegram_db - INFO - Queued property_id 1719 for 1 users
2025-04-20 18:57:33,042 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 1 users
2025-04-20 18:57:33,043 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.00s
2025-04-20 18:57:33,044 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:57:33,718 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:57:33,719 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 0.67s
2025-04-20 18:57:33,719 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:57:33,719 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:57:33,719 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:57:33,720 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:57:33,720 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:57:33,720 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:57:33,720 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:57:33,720 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:57:33,720 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:57:33,720 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:57:34,898 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:57:34,901 - database.telegram_db - INFO - Queued property_id 1720 for 0 users
2025-04-20 18:57:34,901 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:57:34,903 - database.telegram_db - INFO - Queued property_id 1721 for 0 users
2025-04-20 18:57:34,903 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:57:34,905 - database.telegram_db - INFO - Queued property_id 1722 for 1 users
2025-04-20 18:57:34,905 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 1 users
2025-04-20 18:57:34,907 - database.telegram_db - INFO - Queued property_id 1723 for 0 users
2025-04-20 18:57:34,907 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:57:34,908 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.19s
2025-04-20 18:57:34,908 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:57:35,903 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:57:35,908 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.00s
2025-04-20 18:57:35,908 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:57:35,908 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:57:35,908 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:57:35,908 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:57:35,908 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:57:35,908 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:57:35,908 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:57:35,908 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:57:35,908 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:57:35,908 - main - INFO - City-based scanning skipped
2025-04-20 18:57:35,908 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:57:35,908 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:57:35,916 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:57:35,916 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 18:59:18,501 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 18:59:20,558 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 18:59:20.558692
2025-04-20 18:59:20,586 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 18:59:20,586 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 18:59:20,587 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:59:20,597 - database.migrations - INFO - Database initialized successfully
2025-04-20 18:59:20,605 - __main__ - INFO - Running continuous scanning with 500s interval
2025-04-20 18:59:20,605 - main - INFO - Starting new scan cycle...
2025-04-20 18:59:20,607 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 18:59:20,607 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 18:59:22,440 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 18:59:22,441 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 18:59:22,529 - database.telegram_db - INFO - Queued property_id 1724 for 0 users
2025-04-20 18:59:22,548 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 18:59:22,551 - database.telegram_db - INFO - Queued property_id 1725 for 0 users
2025-04-20 18:59:22,551 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 18:59:22,556 - database.telegram_db - INFO - Queued property_id 1726 for 1 users
2025-04-20 18:59:22,556 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 1 users
2025-04-20 18:59:22,560 - database.telegram_db - INFO - Queued property_id 1727 for 2 users
2025-04-20 18:59:22,560 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 2 users
2025-04-20 18:59:22,562 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.95s
2025-04-20 18:59:22,562 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 18:59:23,643 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 18:59:23,676 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 1.10s
2025-04-20 18:59:23,678 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 18:59:23,678 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 18:59:23,678 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 18:59:23,679 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 18:59:23,679 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 18:59:23,679 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 18:59:23,679 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 18:59:23,679 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 18:59:23,679 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 18:59:23,679 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:59:24,686 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:59:24,693 - database.telegram_db - INFO - Queued property_id 1728 for 0 users
2025-04-20 18:59:24,694 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 18:59:24,699 - database.telegram_db - INFO - Queued property_id 1729 for 0 users
2025-04-20 18:59:24,699 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 18:59:24,703 - database.telegram_db - INFO - Queued property_id 1730 for 2 users
2025-04-20 18:59:24,703 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 2 users
2025-04-20 18:59:24,707 - database.telegram_db - INFO - Queued property_id 1731 for 0 users
2025-04-20 18:59:24,707 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 18:59:24,708 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.03s
2025-04-20 18:59:24,708 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 18:59:25,992 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 18:59:25,997 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.29s
2025-04-20 18:59:25,997 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 18:59:25,998 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 18:59:25,998 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 18:59:25,998 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 18:59:25,998 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 18:59:25,998 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 18:59:25,998 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 18:59:25,998 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 18:59:25,998 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 18:59:25,998 - main - INFO - City-based scanning skipped
2025-04-20 18:59:25,998 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 18:59:25,998 - main - INFO - Detecting potential duplicate listings...
2025-04-20 18:59:26,002 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 18:59:26,002 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 19:07:46,006 - main - INFO - Starting new scan cycle...
2025-04-20 19:07:46,021 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 19:07:46,021 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:07:46,568 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 19:07:46,568 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:07:46,569 - utils.http - INFO - Anti-bot retry 1/3 using Safari macOS profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down", waiting 3.5 seconds...
2025-04-20 19:07:51,827 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:07:51,830 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 19:07:51,831 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 19:07:51,841 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 5.82s
2025-04-20 19:07:51,842 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:07:51,842 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 19:07:51,842 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 19:07:51,842 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 19:07:51,842 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 19:07:51,842 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 19:07:51,842 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 19:07:51,842 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 19:07:51,842 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 19:07:51,842 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 19:07:51,842 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 19:07:52,955 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 19:07:52,962 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.12s
2025-04-20 19:07:52,962 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:07:52,962 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 19:07:52,962 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 19:07:52,962 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 19:07:52,962 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 19:07:52,962 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 19:07:52,962 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 19:07:52,962 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 19:07:52,962 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 19:07:52,962 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 19:07:52,962 - main - INFO - City-based scanning skipped
2025-04-20 19:07:52,962 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 19:07:52,962 - main - INFO - Detecting potential duplicate listings...
2025-04-20 19:07:52,963 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 19:07:52,963 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 19:16:12,967 - main - INFO - Starting new scan cycle...
2025-04-20 19:16:12,971 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 19:16:12,971 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:16:14,303 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 19:16:14,304 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 19:16:14,315 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.34s
2025-04-20 19:16:14,315 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:16:14,315 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 19:16:14,315 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 19:16:14,315 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 19:16:14,316 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 19:16:14,316 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 19:16:14,316 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 19:16:14,316 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 19:16:14,316 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 19:16:14,316 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 19:16:14,316 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 19:16:15,253 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 19:16:15,262 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.94s
2025-04-20 19:16:15,262 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:16:15,262 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 19:16:15,262 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 19:16:15,262 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 19:16:15,262 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 19:16:15,262 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 19:16:15,262 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 19:16:15,262 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 19:16:15,262 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 19:16:15,263 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 19:16:15,263 - main - INFO - City-based scanning skipped
2025-04-20 19:16:15,263 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 19:16:15,263 - main - INFO - Detecting potential duplicate listings...
2025-04-20 19:16:15,265 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 19:16:15,265 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 19:24:35,271 - main - INFO - Starting new scan cycle...
2025-04-20 19:24:35,280 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 19:24:35,281 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:24:36,150 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 19:24:36,150 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 19:24:36,161 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 0.88s
2025-04-20 19:24:36,161 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:24:36,161 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 19:24:36,161 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 19:24:36,161 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 19:24:36,161 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 19:24:36,161 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 19:24:36,161 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 19:24:36,161 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 19:24:36,161 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 19:24:36,161 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 19:24:36,161 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 19:24:37,394 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 19:24:37,401 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.24s
2025-04-20 19:24:37,401 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:24:37,401 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 19:24:37,402 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 19:24:37,402 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 19:24:37,402 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 19:24:37,402 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 19:24:37,402 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 19:24:37,402 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 19:24:37,402 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 19:24:37,402 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 19:24:37,402 - main - INFO - City-based scanning skipped
2025-04-20 19:24:37,402 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 19:24:37,402 - main - INFO - Detecting potential duplicate listings...
2025-04-20 19:24:37,404 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 19:24:37,404 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 19:32:57,408 - main - INFO - Starting new scan cycle...
2025-04-20 19:32:57,417 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 19:32:57,418 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:32:58,506 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 19:32:58,507 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 19:32:58,514 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.09s
2025-04-20 19:32:58,514 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:32:58,514 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 19:32:58,514 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 19:32:58,514 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 19:32:58,514 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 19:32:58,514 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 19:32:58,514 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 19:32:58,514 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 19:32:58,514 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 19:32:58,514 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 19:32:58,514 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 19:32:59,227 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 19:32:59,235 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.72s
2025-04-20 19:32:59,235 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:32:59,235 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 19:32:59,235 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 19:32:59,235 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 19:32:59,235 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 19:32:59,235 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 19:32:59,235 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 19:32:59,235 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 19:32:59,235 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 19:32:59,235 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 19:32:59,235 - main - INFO - City-based scanning skipped
2025-04-20 19:32:59,235 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 19:32:59,235 - main - INFO - Detecting potential duplicate listings...
2025-04-20 19:32:59,238 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 19:32:59,238 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 19:41:19,242 - main - INFO - Starting new scan cycle...
2025-04-20 19:41:19,252 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 19:41:19,252 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:41:21,417 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 19:41:21,418 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 19:41:21,424 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 2.17s
2025-04-20 19:41:21,424 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:41:21,424 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 19:41:21,425 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 19:41:21,425 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 19:41:21,425 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 19:41:21,425 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 19:41:21,425 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 19:41:21,425 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 19:41:21,425 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 19:41:21,425 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 19:41:21,425 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 19:41:22,580 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 19:41:22,586 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.16s
2025-04-20 19:41:22,586 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:41:22,586 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 19:41:22,586 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 19:41:22,586 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 19:41:22,586 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 19:41:22,586 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 19:41:22,586 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 19:41:22,586 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 19:41:22,586 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 19:41:22,587 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 19:41:22,587 - main - INFO - City-based scanning skipped
2025-04-20 19:41:22,587 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 19:41:22,587 - main - INFO - Detecting potential duplicate listings...
2025-04-20 19:41:22,588 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 19:41:22,588 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 19:49:42,606 - main - INFO - Starting new scan cycle...
2025-04-20 19:49:42,616 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 19:49:42,616 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:49:43,161 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 19:49:43,162 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:49:43,163 - utils.http - INFO - Anti-bot retry 1/3 using Firefox Linux profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down", waiting 4.1 seconds...
2025-04-20 19:49:48,820 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:49:48,823 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 19:49:48,823 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 19:49:48,833 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 6.21s
2025-04-20 19:49:48,833 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:49:48,833 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 19:49:48,833 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 19:49:48,833 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 19:49:48,833 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 19:49:48,833 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 19:49:48,833 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 19:49:48,833 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 19:49:48,833 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 19:49:48,833 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 19:49:48,833 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 19:49:49,926 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 19:49:49,936 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.10s
2025-04-20 19:49:49,936 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:49:49,936 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 19:49:49,936 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 19:49:49,936 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 19:49:49,936 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 19:49:49,936 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 19:49:49,936 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 19:49:49,936 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 19:49:49,936 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 19:49:49,936 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 19:49:49,936 - main - INFO - City-based scanning skipped
2025-04-20 19:49:49,936 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 19:49:49,936 - main - INFO - Detecting potential duplicate listings...
2025-04-20 19:49:49,939 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 19:49:49,939 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 19:58:09,944 - main - INFO - Starting new scan cycle...
2025-04-20 19:58:09,949 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 19:58:09,950 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 19:58:11,061 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 19:58:11,062 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 19:58:11,068 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.12s
2025-04-20 19:58:11,068 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:58:11,068 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 19:58:11,068 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 19:58:11,068 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 19:58:11,069 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 19:58:11,069 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 19:58:11,069 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 19:58:11,069 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 19:58:11,069 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 19:58:11,069 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 19:58:11,069 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 19:58:12,284 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 19:58:12,289 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.22s
2025-04-20 19:58:12,289 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 19:58:12,289 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 19:58:12,289 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 19:58:12,289 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 19:58:12,289 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 19:58:12,289 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 19:58:12,289 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 19:58:12,289 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 19:58:12,289 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 19:58:12,289 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 19:58:12,289 - main - INFO - City-based scanning skipped
2025-04-20 19:58:12,289 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 19:58:12,289 - main - INFO - Detecting potential duplicate listings...
2025-04-20 19:58:12,290 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 19:58:12,290 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 20:08:23,761 - main - INFO - Starting new scan cycle...
2025-04-20 20:08:23,770 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 20:08:23,770 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 20:08:24,998 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 20:08:24,999 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 20:08:25,013 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.24s
2025-04-20 20:08:25,013 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 20:08:25,013 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 20:08:25,013 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 20:08:25,013 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 20:08:25,013 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 20:08:25,013 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 20:08:25,013 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 20:08:25,014 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 20:08:25,014 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 20:08:25,014 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 20:08:25,014 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 20:08:25,710 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 20:08:25,720 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.70s
2025-04-20 20:08:25,720 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 20:08:25,720 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 20:08:25,720 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 20:08:25,720 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 20:08:25,720 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 20:08:25,720 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 20:08:25,720 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 20:08:25,720 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 20:08:25,720 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 20:08:25,720 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 20:08:25,720 - main - INFO - City-based scanning skipped
2025-04-20 20:08:25,721 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 20:08:25,721 - main - INFO - Detecting potential duplicate listings...
2025-04-20 20:08:25,723 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 20:08:25,724 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 20:38:56,420 - main - INFO - Starting new scan cycle...
2025-04-20 20:38:56,427 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 20:38:56,427 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 20:38:57,372 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 20:38:57,372 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 20:38:57,373 - utils.http - INFO - Anti-bot retry 1/3 using Mobile Safari iOS profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down", waiting 2.3 seconds...
2025-04-20 20:39:01,334 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 20:39:01,337 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 20:39:01,338 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 20:39:01,349 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 4.92s
2025-04-20 20:39:01,349 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 20:39:01,349 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 20:39:01,349 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 20:39:01,349 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 20:39:01,350 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 20:39:01,350 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 20:39:01,350 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 20:39:01,350 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 20:39:01,350 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 20:39:01,350 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 20:39:01,350 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 20:39:02,315 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 20:39:02,321 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.97s
2025-04-20 20:39:02,321 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 20:39:02,321 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 20:39:02,321 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 20:39:02,321 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 20:39:02,321 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 20:39:02,321 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 20:39:02,321 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 20:39:02,321 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 20:39:02,321 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 20:39:02,321 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 20:39:02,321 - main - INFO - City-based scanning skipped
2025-04-20 20:39:02,321 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 20:39:02,321 - main - INFO - Detecting potential duplicate listings...
2025-04-20 20:39:02,323 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 20:39:02,323 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 20:47:22,329 - main - INFO - Starting new scan cycle...
2025-04-20 20:47:22,338 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 20:47:22,339 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 20:47:23,249 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 20:47:23,250 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 20:47:23,263 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 0.92s
2025-04-20 20:47:23,263 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 20:47:23,263 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 20:47:23,263 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 20:47:23,263 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 20:47:23,263 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 20:47:23,263 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 20:47:23,263 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 20:47:23,263 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 20:47:23,263 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 20:47:23,263 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 20:47:23,263 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 20:47:23,942 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 20:47:23,951 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.69s
2025-04-20 20:47:23,951 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 20:47:23,951 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 20:47:23,951 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 20:47:23,951 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 20:47:23,951 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 20:47:23,951 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 20:47:23,951 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 20:47:23,951 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 20:47:23,951 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 20:47:23,951 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 20:47:23,952 - main - INFO - City-based scanning skipped
2025-04-20 20:47:23,952 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 20:47:23,952 - main - INFO - Detecting potential duplicate listings...
2025-04-20 20:47:23,954 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 20:47:23,954 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 20:50:32,967 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 20:50:53,578 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 20:50:53.578528
2025-04-20 20:50:53,608 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 20:50:53,608 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 20:50:53,609 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 20:50:53,615 - database.migrations - INFO - Database initialized successfully
2025-04-20 20:50:53,622 - __main__ - INFO - Running continuous scanning with 500s interval
2025-04-20 20:50:53,622 - main - INFO - Starting new scan cycle...
2025-04-20 20:50:53,624 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 20:50:53,625 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 20:50:55,034 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 20:50:55,035 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 20:50:55,090 - database.telegram_db - INFO - Queued property_id 1732 for 1 users
2025-04-20 20:50:55,091 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 1 users
2025-04-20 20:50:55,093 - database.telegram_db - INFO - Queued property_id 1733 for 1 users
2025-04-20 20:50:55,093 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 1 users
2025-04-20 20:50:55,094 - database.telegram_db - INFO - Queued property_id 1734 for 1 users
2025-04-20 20:50:55,094 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 1 users
2025-04-20 20:50:55,097 - database.telegram_db - INFO - Queued property_id 1735 for 1 users
2025-04-20 20:50:55,097 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 1 users
2025-04-20 20:50:55,098 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.47s
2025-04-20 20:50:55,098 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 20:50:55,854 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 20:50:55,856 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 0.76s
2025-04-20 20:50:55,856 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 20:50:55,856 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 20:50:55,856 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 20:50:55,856 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 20:50:55,856 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 20:50:55,856 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 20:50:55,856 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 20:50:55,856 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 20:50:55,856 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 20:50:55,856 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 20:50:56,965 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 20:50:56,974 - database.telegram_db - INFO - Queued property_id 1736 for 1 users
2025-04-20 20:50:56,974 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 1 users
2025-04-20 20:50:56,983 - database.telegram_db - INFO - Queued property_id 1737 for 1 users
2025-04-20 20:50:56,983 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 1 users
2025-04-20 20:50:56,987 - database.telegram_db - INFO - Queued property_id 1738 for 1 users
2025-04-20 20:50:56,988 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 1 users
2025-04-20 20:50:56,992 - database.telegram_db - INFO - Queued property_id 1739 for 1 users
2025-04-20 20:50:56,993 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 1 users
2025-04-20 20:50:56,994 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.14s
2025-04-20 20:50:56,994 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 20:50:57,723 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 20:50:57,738 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 0.74s
2025-04-20 20:50:57,738 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 20:50:57,739 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 20:50:57,739 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 20:50:57,739 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 20:50:57,739 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 20:50:57,739 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 20:50:57,739 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 20:50:57,739 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 20:50:57,739 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 20:50:57,739 - main - INFO - City-based scanning skipped
2025-04-20 20:50:57,739 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 20:50:57,739 - main - INFO - Detecting potential duplicate listings...
2025-04-20 20:50:57,757 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 20:50:57,757 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 20:54:36,082 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 20:54:53,215 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 20:54:53.215366
2025-04-20 20:54:53,246 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 20:54:53,246 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 20:54:53,247 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 20:54:53,259 - database.migrations - INFO - Database initialized successfully
2025-04-20 20:54:53,268 - __main__ - INFO - Running continuous scanning with 500s interval
2025-04-20 20:54:53,268 - main - INFO - Starting new scan cycle...
2025-04-20 20:54:53,270 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 20:54:53,270 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 20:54:53,917 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 20:54:53,918 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 20:54:53,971 - database.telegram_db - INFO - Queued property_id 1740 for 0 users
2025-04-20 20:54:53,971 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 20:54:53,972 - database.telegram_db - INFO - Queued property_id 1741 for 0 users
2025-04-20 20:54:53,972 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 20:54:53,974 - database.telegram_db - INFO - Queued property_id 1742 for 0 users
2025-04-20 20:54:53,974 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 20:54:53,976 - database.telegram_db - INFO - Queued property_id 1743 for 0 users
2025-04-20 20:54:53,976 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 20:54:53,977 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 0.71s
2025-04-20 20:54:53,977 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 20:54:54,578 - utils.http - WARNING - Anti-bot pattern detected: 'Je bent bijna op de pagina die je zoekt'
2025-04-20 20:54:54,578 - utils.http - WARNING - Anti-bot measures detected (retry 1/3) for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 20:54:54,579 - utils.http - INFO - Anti-bot retry 1/3 using Mobile Safari iOS profile for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down", waiting 4.9 seconds...
2025-04-20 20:55:00,382 - utils.http - INFO - Successfully bypassed anti-bot measures after 1 retries for https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 20:55:00,384 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 20:55:00,385 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 6.41s
2025-04-20 20:55:00,386 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 20:55:00,386 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 20:55:00,386 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 20:55:00,386 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 20:55:00,386 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 20:55:00,386 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 20:55:00,386 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 20:55:00,386 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 20:55:00,386 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 20:55:00,386 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 20:55:01,509 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 20:55:01,514 - database.telegram_db - INFO - Queued property_id 1744 for 0 users
2025-04-20 20:55:01,514 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 20:55:01,516 - database.telegram_db - INFO - Queued property_id 1745 for 0 users
2025-04-20 20:55:01,516 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 20:55:01,518 - database.telegram_db - INFO - Queued property_id 1746 for 0 users
2025-04-20 20:55:01,518 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 20:55:01,520 - database.telegram_db - INFO - Queued property_id 1747 for 0 users
2025-04-20 20:55:01,520 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 20:55:01,521 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.13s
2025-04-20 20:55:01,521 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 20:55:02,418 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 20:55:02,422 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 0.90s
2025-04-20 20:55:02,422 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 20:55:02,423 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 20:55:02,423 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 20:55:02,423 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 20:55:02,423 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 20:55:02,423 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 20:55:02,423 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 20:55:02,423 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 20:55:02,423 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 20:55:02,423 - main - INFO - City-based scanning skipped
2025-04-20 20:55:02,423 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 20:55:02,423 - main - INFO - Detecting potential duplicate listings...
2025-04-20 20:55:02,432 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 20:55:02,432 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 21:03:22,439 - main - INFO - Starting new scan cycle...
2025-04-20 21:03:22,462 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 21:03:22,463 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 21:03:23,806 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 21:03:23,807 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 21:03:23,824 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 1.36s
2025-04-20 21:03:23,824 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 21:03:23,824 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 21:03:23,824 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 21:03:23,824 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 21:03:23,824 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 21:03:23,824 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 21:03:23,824 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 21:03:23,824 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 21:03:23,824 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 21:03:23,825 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 21:03:23,825 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 21:03:24,562 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 21:03:24,575 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 0.75s
2025-04-20 21:03:24,575 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 21:03:24,575 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 21:03:24,575 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 21:03:24,575 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 21:03:24,575 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 21:03:24,575 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 21:03:24,575 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 21:03:24,575 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 21:03:24,575 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 21:03:24,575 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 21:03:24,575 - main - INFO - City-based scanning skipped
2025-04-20 21:03:24,576 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 21:03:24,576 - main - INFO - Detecting potential duplicate listings...
2025-04-20 21:03:24,578 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 21:03:24,578 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 21:06:08,927 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 21:06:10,823 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 21:06:10.823234
2025-04-20 21:06:10,847 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 21:06:10,847 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 21:06:10,848 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 21:06:10,857 - database.migrations - INFO - Database initialized successfully
2025-04-20 21:06:10,866 - __main__ - INFO - Running continuous scanning with 500s interval
2025-04-20 21:06:10,866 - main - INFO - Starting new scan cycle...
2025-04-20 21:06:10,869 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 21:06:10,870 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 21:06:11,990 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 21:06:11,991 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 21:06:12,249 - database.telegram_db - INFO - Queued property_id 1748 for 0 users
2025-04-20 21:06:12,250 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 21:06:12,267 - database.telegram_db - INFO - Queued property_id 1749 for 0 users
2025-04-20 21:06:12,290 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 21:06:12,295 - database.telegram_db - INFO - Queued property_id 1750 for 0 users
2025-04-20 21:06:12,295 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 21:06:12,300 - database.telegram_db - INFO - Queued property_id 1751 for 0 users
2025-04-20 21:06:12,300 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 0 users
2025-04-20 21:06:12,303 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.43s
2025-04-20 21:06:12,303 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 21:06:13,580 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 21:06:13,593 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 1.28s
2025-04-20 21:06:13,594 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 21:06:13,594 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 21:06:13,594 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 21:06:13,594 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 21:06:13,594 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 21:06:13,594 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 21:06:13,594 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 21:06:13,594 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 21:06:13,594 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 21:06:13,594 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 21:06:14,371 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 21:06:14,377 - database.telegram_db - INFO - Queued property_id 1752 for 0 users
2025-04-20 21:06:14,377 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 21:06:14,381 - database.telegram_db - INFO - Queued property_id 1753 for 0 users
2025-04-20 21:06:14,381 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 21:06:14,384 - database.telegram_db - INFO - Queued property_id 1754 for 0 users
2025-04-20 21:06:14,384 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 0 users
2025-04-20 21:06:14,387 - database.telegram_db - INFO - Queued property_id 1755 for 0 users
2025-04-20 21:06:14,387 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 21:06:14,388 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 0.79s
2025-04-20 21:06:14,388 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 21:06:15,664 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 21:06:15,676 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 1.29s
2025-04-20 21:06:15,676 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 21:06:15,676 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 21:06:15,676 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 21:06:15,676 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 21:06:15,676 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 21:06:15,676 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 21:06:15,676 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 21:06:15,676 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 21:06:15,676 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 21:06:15,676 - main - INFO - City-based scanning skipped
2025-04-20 21:06:15,676 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 21:06:15,676 - main - INFO - Detecting potential duplicate listings...
2025-04-20 21:06:15,684 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 21:06:15,684 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 21:06:16,834 - asyncio - ERROR - Exception in callback main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359
handle: <Handle main.<locals>.<lambda>() at /Users/kevinhang/Documents/HousingProject/cli.py:359>
Traceback (most recent call last):
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/kevinhang/Documents/HousingProject/cli.py", line 359, in <lambda>
    lambda: asyncio.create_task(stop_event.set())
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/tasks.py", line 337, in create_task
    task = loop.create_task(coro)
  File "/Users/kevinhang/.pyenv/versions/3.10.12/lib/python3.10/asyncio/base_events.py", line 438, in create_task
    task = tasks.Task(coro, loop=self, name=name)
TypeError: a coroutine was expected, got None
2025-04-20 21:06:44,260 - __main__ - INFO - Starting Dutch Real Estate Scraper CLI at 2025-04-20 21:06:44.260484
2025-04-20 21:06:44,339 - __main__ - INFO - Starting scraper for sources: ['funda', 'pararius']
2025-04-20 21:06:44,339 - __main__ - INFO - Scan mode: Query URLs
2025-04-20 21:06:44,341 - __main__ - INFO - Found 20 enabled query URLs to scan
2025-04-20 21:06:44,361 - database.migrations - INFO - Database initialized successfully
2025-04-20 21:06:44,373 - __main__ - INFO - Running continuous scanning with 500s interval
2025-04-20 21:06:44,374 - main - INFO - Starting new scan cycle...
2025-04-20 21:06:44,378 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 21:06:44,378 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 21:06:45,728 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 21:06:45,729 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 21:06:45,780 - database.telegram_db - INFO - Queued property_id 1756 for 0 users
2025-04-20 21:06:45,780 - main - INFO - Added new listing: Turfhorst 4-A (funda -  2.700 /maand), queued for 0 users
2025-04-20 21:06:45,782 - database.telegram_db - INFO - Queued property_id 1757 for 0 users
2025-04-20 21:06:45,782 - main - INFO - Added new listing: Parelmoerhorst 14 (funda -  1.995 /maand), queued for 0 users
2025-04-20 21:06:45,783 - database.telegram_db - INFO - Queued property_id 1758 for 0 users
2025-04-20 21:06:45,784 - main - INFO - Added new listing: Gelrestraat 51 (funda -  2.325 /maand), queued for 0 users
2025-04-20 21:06:45,786 - database.telegram_db - INFO - Queued property_id 1759 for 1 users
2025-04-20 21:06:45,786 - main - INFO - Added new listing: Carnapstraat 70 (funda -  2.425 /maand), queued for 1 users
2025-04-20 21:06:45,787 - main - INFO - Completed scan of query URL (ID=1): 4 new, 4 total in 1.41s
2025-04-20 21:06:45,788 - main - INFO - Scanning specific funda URL (ID=2): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&search_result=2&sort="date_down"
2025-04-20 21:06:46,946 - main - INFO - Found 0 listings for funda from specific URL
2025-04-20 21:06:46,948 - main - INFO - Completed scan of query URL (ID=2): 0 new, 0 total in 1.16s
2025-04-20 21:06:46,948 - main - INFO - Scan of funda query URL (ID=2) succeeded with no result. End of pagination reached.
2025-04-20 21:06:46,948 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 21:06:46,948 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 21:06:46,948 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 21:06:46,948 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 21:06:46,948 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 21:06:46,948 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 21:06:46,948 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 21:06:46,948 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 21:06:46,948 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 21:06:47,977 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 21:06:47,981 - database.telegram_db - INFO - Queued property_id 1760 for 0 users
2025-04-20 21:06:47,981 - main - INFO - Added new listing: Room Veestraat (pararius - 470 per month), queued for 0 users
2025-04-20 21:06:47,983 - database.telegram_db - INFO - Queued property_id 1761 for 0 users
2025-04-20 21:06:47,983 - main - INFO - Added new listing: Flat Steenbergsestraat (pararius - 950 per month), queued for 0 users
2025-04-20 21:06:47,985 - database.telegram_db - INFO - Queued property_id 1762 for 1 users
2025-04-20 21:06:47,986 - main - INFO - Added new listing: Flat Hoofdweg 604 (pararius - 2,500 per month), queued for 1 users
2025-04-20 21:06:47,987 - database.telegram_db - INFO - Queued property_id 1763 for 0 users
2025-04-20 21:06:47,987 - main - INFO - Added new listing: Flat Endepolsdomein (pararius - 896 per month), queued for 0 users
2025-04-20 21:06:47,988 - main - INFO - Completed scan of query URL (ID=11): 4 new, 4 total in 1.04s
2025-04-20 21:06:47,988 - main - INFO - Scanning specific pararius URL (ID=12): https://www.pararius.com/apartments/nederland/since-1/page-2
2025-04-20 21:06:48,791 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 21:06:48,795 - main - INFO - Completed scan of query URL (ID=12): 0 new, 4 total in 0.81s
2025-04-20 21:06:48,795 - main - INFO - Pagination ended for pararius: URL https://www.pararius.com/apartments/nederland/since-1/page-2 redirected to https://www.pararius.com/apartments/nederland/since-1
2025-04-20 21:06:48,795 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 21:06:48,795 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 21:06:48,795 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 21:06:48,795 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 21:06:48,795 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 21:06:48,795 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 21:06:48,795 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 21:06:48,795 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 21:06:48,796 - main - INFO - City-based scanning skipped
2025-04-20 21:06:48,796 - main - INFO - Scan complete: 8 new listings from 12 total processed
2025-04-20 21:06:48,796 - main - INFO - Detecting potential duplicate listings...
2025-04-20 21:06:48,805 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 21:06:48,805 - main - INFO - Waiting 500 seconds until next scan...
2025-04-20 21:15:08,793 - main - INFO - Starting new scan cycle...
2025-04-20 21:15:08,810 - main - INFO - Found 20 enabled query URLs to scan
2025-04-20 21:15:08,811 - main - INFO - Scanning specific funda URL (ID=1): https://www.funda.nl/zoeken/huur?object_type=["house","apartment"]&publication_date="1"&sort="date_down"
2025-04-20 21:15:09,596 - scrapers.funda - INFO - Found 5 listing elements to process
2025-04-20 21:15:09,596 - main - INFO - Found 4 listings for funda from specific URL
2025-04-20 21:15:09,607 - main - INFO - Completed scan of query URL (ID=1): 0 new, 4 total in 0.79s
2025-04-20 21:15:09,607 - main - INFO - First scan of funda query URL (ID=1) resulted in no new listings. Skipping new pages of this source.
2025-04-20 21:15:09,607 - main - INFO - Skipping query URL (ID=2) - source funda marked for skipping
2025-04-20 21:15:09,607 - main - INFO - Skipping query URL (ID=3) - source funda marked for skipping
2025-04-20 21:15:09,607 - main - INFO - Skipping query URL (ID=4) - source funda marked for skipping
2025-04-20 21:15:09,607 - main - INFO - Skipping query URL (ID=5) - source funda marked for skipping
2025-04-20 21:15:09,607 - main - INFO - Skipping query URL (ID=6) - source funda marked for skipping
2025-04-20 21:15:09,607 - main - INFO - Skipping query URL (ID=7) - source funda marked for skipping
2025-04-20 21:15:09,607 - main - INFO - Skipping query URL (ID=8) - source funda marked for skipping
2025-04-20 21:15:09,607 - main - INFO - Skipping query URL (ID=9) - source funda marked for skipping
2025-04-20 21:15:09,607 - main - INFO - Skipping query URL (ID=10) - source funda marked for skipping
2025-04-20 21:15:09,607 - main - INFO - Scanning specific pararius URL (ID=11): https://www.pararius.com/apartments/nederland/since-1
2025-04-20 21:15:10,756 - main - INFO - Found 4 listings for pararius from specific URL
2025-04-20 21:15:10,765 - main - INFO - Completed scan of query URL (ID=11): 0 new, 4 total in 1.16s
2025-04-20 21:15:10,765 - main - INFO - First scan of pararius query URL (ID=11) resulted in no new listings. Skipping new pages of this source.
2025-04-20 21:15:10,765 - main - INFO - Skipping query URL (ID=12) - source pararius marked for skipping
2025-04-20 21:15:10,765 - main - INFO - Skipping query URL (ID=13) - source pararius marked for skipping
2025-04-20 21:15:10,765 - main - INFO - Skipping query URL (ID=14) - source pararius marked for skipping
2025-04-20 21:15:10,765 - main - INFO - Skipping query URL (ID=15) - source pararius marked for skipping
2025-04-20 21:15:10,765 - main - INFO - Skipping query URL (ID=16) - source pararius marked for skipping
2025-04-20 21:15:10,765 - main - INFO - Skipping query URL (ID=17) - source pararius marked for skipping
2025-04-20 21:15:10,765 - main - INFO - Skipping query URL (ID=18) - source pararius marked for skipping
2025-04-20 21:15:10,765 - main - INFO - Skipping query URL (ID=19) - source pararius marked for skipping
2025-04-20 21:15:10,765 - main - INFO - Skipping query URL (ID=20) - source pararius marked for skipping
2025-04-20 21:15:10,765 - main - INFO - City-based scanning skipped
2025-04-20 21:15:10,765 - main - INFO - Scan complete: 0 new listings from 8 total processed
2025-04-20 21:15:10,765 - main - INFO - Detecting potential duplicate listings...
2025-04-20 21:15:10,767 - main - INFO - Found 0 potential duplicate pairs
2025-04-20 21:15:10,767 - main - INFO - Waiting 500 seconds until next scan...
